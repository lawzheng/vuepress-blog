(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{499:function(t,a,s){"use strict";s.r(a);var n=s(70),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"站在前端研发的视角-分析开发脚手架的必要性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#站在前端研发的视角-分析开发脚手架的必要性"}},[t._v("#")]),t._v(" 站在前端研发的视角，分析开发脚手架的必要性")]),t._v(" "),s("h2",{attrs:{id:"研发效能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#研发效能"}},[t._v("#")]),t._v(" 研发效能")]),t._v(" "),s("p",[t._v("脚手架的核心目标是："),s("strong",[t._v("提升前端研发效能")])]),t._v(" "),s("p",[t._v("大厂研发架构图：")]),t._v(" "),s("h2",{attrs:{id:"脚手架核心价值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架核心价值"}},[t._v("#")]),t._v(" 脚手架核心价值")]),t._v(" "),s("p",[t._v("将研发过程：")]),t._v(" "),s("ul",[s("li",[t._v("自动化：项目重复代码拷贝/git操作/发布上线操作")]),t._v(" "),s("li",[t._v("标准化：项目创建/git flow/发布流程/回滚流程")]),t._v(" "),s("li",[t._v("数据化：研发过程系统化、数据化，使得研发过程可量化")])]),t._v(" "),s("h2",{attrs:{id:"和自动化构建工具的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#和自动化构建工具的区别"}},[t._v("#")]),t._v(" 和自动化构建工具的区别")]),t._v(" "),s("p",[t._v("问题：Jenkins、Travis等自动化构建工具已经比较成熟了，为什么还需要自研脚手架？")]),t._v(" "),s("ul",[s("li",[t._v("不满足需求：Jenkins、Travis通常在git hooks中触发，需要在服务端执行（仅仅只能覆盖云构建端的操作），无法覆盖研发人员本地的功能，如：创建项目自动化，本地git操作自动化等")]),t._v(" "),s("li",[t._v("定制复杂：Jenkins、Travis定制过程需要开发插件，其过程较为复杂，需要使用java语言，对前端同学不够友好")])]),t._v(" "),s("h2",{attrs:{id:"从使用角度理解什么是脚手架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从使用角度理解什么是脚手架"}},[t._v("#")]),t._v(" 从使用角度理解什么是脚手架")]),t._v(" "),s("h3",{attrs:{id:"脚手架简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架简介"}},[t._v("#")]),t._v(" 脚手架简介")]),t._v(" "),s("p",[t._v("脚手架本质是一个操作系统的客户端，它通过命令执行，比如：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vue create vue-test-app\n")])])]),s("p",[t._v("上面命令由3个部分组成：")]),t._v(" "),s("ul",[s("li",[t._v("主命令："),s("code",[t._v("vue")])]),t._v(" "),s("li",[t._v("command："),s("code",[t._v("create")])]),t._v(" "),s("li",[t._v("command的params："),s("code",[t._v("vue-test-app")])])]),t._v(" "),s("p",[t._v("他表示创建一个vue的项目，项目的名称为"),s("code",[t._v("vue-test-app")]),t._v("，以上是一个较为简单的脚手架命令，但实际场景往往更加复杂，比如：")]),t._v(" "),s("p",[t._v("当前目录已经有文件了，我们需要覆盖当前目录下的文件，强制进行安装"),s("code",[t._v("vue")]),t._v("项目，此时我们就可以输入")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vue create vue-test-app --force\n")])])]),s("p",[t._v("这里的"),s("code",[t._v("--force")]),t._v("叫做option，用来辅助脚手架确定在特定场景下用户的选择（可以理解为配置）。还有一种场景：")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("vue create")]),t._v("创建项目时，会自动执行"),s("code",[t._v("npm install")]),t._v("帮用户安装依赖，如果我们希望使用淘宝源来安装，可以使用命令：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vue create vue-test-app --force -r https://registry.npm.taobao.org\n")])])]),s("p",[t._v("这里的"),s("code",[t._v("-r")]),t._v("也叫做option，它与"),s("code",[t._v("--force")]),t._v("不同的是它使用"),s("code",[t._v("-")]),t._v("，并且使用了简写，这里的"),s("code",[t._v("-r")]),t._v("也可以替换成"),s("code",[t._v("--registry")]),t._v("，如果不知道"),s("code",[t._v("vue create")]),t._v("支持的所有options，可以使用：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vue create --help\n")])])]),s("p",[s("code",[t._v("-r https://registry.npm.taobao.org")]),t._v("后面的"),s("code",[t._v("https://registry.npm.taobao.org")]),t._v("成为option的param，其实"),s("code",[t._v("--force")]),t._v("可以理解为："),s("code",[t._v("--force true")]),t._v("，简写为："),s("code",[t._v("--force")]),t._v("或"),s("code",[t._v("-f")])]),t._v(" "),s("h3",{attrs:{id:"脚手架执行原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架执行原理"}},[t._v("#")]),t._v(" 脚手架执行原理")]),t._v(" "),s("p",[t._v("脚手架的执行原理如下：")]),t._v(" "),s("ul",[s("li",[t._v("在终端输入"),s("code",[t._v("vue create vue-test-app")])]),t._v(" "),s("li",[t._v("终端解析出"),s("code",[t._v("vue")]),t._v("命令")]),t._v(" "),s("li",[t._v("终端在环境变量中找到"),s("code",[t._v("vue")]),t._v("命令")]),t._v(" "),s("li",[t._v("终端根据"),s("code",[t._v("vue")]),t._v("命令链接到实际文件"),s("code",[t._v("vue.js")])]),t._v(" "),s("li",[t._v("终端利用"),s("code",[t._v("node")]),t._v("执行"),s("code",[t._v("vue.js")])]),t._v(" "),s("li",[s("code",[t._v("vue.js")]),t._v("解析command/options")]),t._v(" "),s("li",[s("code",[t._v("vue.js")]),t._v("执行command/options")]),t._v(" "),s("li",[t._v("执行完毕，退出执行")])]),t._v(" "),s("h2",{attrs:{id:"从应用角度看如何开发一个脚手架"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从应用角度看如何开发一个脚手架"}},[t._v("#")]),t._v(" 从应用角度看如何开发一个脚手架")]),t._v(" "),s("p",[t._v("这里以"),s("code",[t._v("vue-cli")]),t._v("为例：")]),t._v(" "),s("ul",[s("li",[t._v("开发"),s("code",[t._v("npm")]),t._v("项目，该项目中应包含一个"),s("code",[t._v("bin/vue.js")]),t._v("文件，并将这个项目发布到"),s("code",[t._v("npm")])]),t._v(" "),s("li",[t._v("将"),s("code",[t._v("npm")]),t._v("项目安装到"),s("code",[t._v("node")]),t._v("的"),s("code",[t._v("lib/node_modules")])]),t._v(" "),s("li",[t._v("在"),s("code",[t._v("node")]),t._v("的"),s("code",[t._v("bin")]),t._v("目录下配置"),s("code",[t._v("vue")]),t._v("软连接指向"),s("code",[t._v("lib/node_modules/@vue/cli/bin/vue.js")])])]),t._v(" "),s("p",[t._v("这样我们在执行"),s("code",[t._v("vue")]),t._v("命令的时候就可以找到"),s("code",[t._v("vue.js")]),t._v("进行执行")]),t._v(" "),s("h3",{attrs:{id:"疑问解答"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#疑问解答"}},[t._v("#")]),t._v(" 疑问解答")]),t._v(" "),s("h4",{attrs:{id:"为什么全局安装-vue-cli后会添加的命令为vue"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么全局安装-vue-cli后会添加的命令为vue"}},[t._v("#")]),t._v(" 为什么全局安装"),s("code",[t._v("@vue/cli")]),t._v("后会添加的命令为"),s("code",[t._v("vue")]),t._v("？")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g @vue/cli\n")])])]),s("p",[t._v("答：在"),s("code",[t._v("/usr/local/lib/node_modules/@vue/cli")]),t._v("文件夹下的"),s("code",[t._v("package.json")]),t._v("的")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bin"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bin/vue.js"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这个软连接的名称就是"),s("code",[t._v("vue")]),t._v("，所以添加后的命令为"),s("code",[t._v("vue")])]),t._v(" "),s("h4",{attrs:{id:"全局安装-vue-cli时发生了什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局安装-vue-cli时发生了什么"}},[t._v("#")]),t._v(" 全局安装"),s("code",[t._v("@vue/cli")]),t._v("时发生了什么？")]),t._v(" "),s("p",[t._v("答：先把"),s("code",[t._v("@vue/cli")]),t._v("下载到"),s("code",[t._v("/usr/local/lib/node_modules")]),t._v("中，然后根据"),s("code",[t._v("@vue/cli")]),t._v("下的"),s("code",[t._v("package.json")]),t._v("，根据"),s("code",[t._v("bin")]),t._v("中的定义去"),s("code",[t._v("/usr/local/bin/")]),t._v("下去定义"),s("code",[t._v("@vue/cli")]),t._v("的软连接"),s("code",[t._v("vue")])]),t._v(" "),s("h4",{attrs:{id:"执行vue命令时发生了什么-为什么vue指向一个js文件-我们却可以直接通过vue命令去执行它"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#执行vue命令时发生了什么-为什么vue指向一个js文件-我们却可以直接通过vue命令去执行它"}},[t._v("#")]),t._v(" 执行"),s("code",[t._v("vue")]),t._v("命令时发生了什么？为什么"),s("code",[t._v("vue")]),t._v("指向一个"),s("code",[t._v("js")]),t._v("文件，我们却可以直接通过"),s("code",[t._v("vue")]),t._v("命令去执行它？")]),t._v(" "),s("p",[t._v("答：1.终端在环境变量中找"),s("code",[t._v("vue")]),t._v("指令（相当于"),s("code",[t._v("which vue")]),t._v("命令），看有没有被注册，未注册则返回"),s("code",[t._v("command not found")]),t._v(",注册了则去找vue指令软连接指向的地址"),s("code",[t._v("/usr/local/lib/node_modules/@vue/cli/bin/vue.js")]),t._v("，去执行"),s("code",[t._v("vue.js")]),t._v("文件中的代码")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("\t2.因为这个`js`文件的顶部写了`#!/usr/bin/env node`,标识在环境变量中查找`node`，告诉系统使用`node`去执行这个`js`文件\n")])])]),s("h3",{attrs:{id:"脚手架原理进阶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架原理进阶"}},[t._v("#")]),t._v(" 脚手架原理进阶")]),t._v(" "),s("h4",{attrs:{id:"为什么说脚手架本质是操作系统的客户端-它和我们在pc上安装的应用-软件有什么区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么说脚手架本质是操作系统的客户端-它和我们在pc上安装的应用-软件有什么区别"}},[t._v("#")]),t._v(" 为什么说脚手架本质是操作系统的客户端？它和我们在PC上安装的应用/软件有什么区别？")]),t._v(" "),s("p",[t._v("1.node在window中是一个node.exe，在Mac中是一个可执行文件（node*）,因为node是操作系统的一个客户端，脚手架的本质是通过node去执行js文件，所以也可以说脚手架的本质是操作系统的客户端。")]),t._v(" "),s("p",[t._v("2.本质来说没有区别，PC安装的应用只是提供了一个GUI，脚手架是通过命令的形式")]),t._v(" "),s("h4",{attrs:{id:"如何为node脚手架命令创建别名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何为node脚手架命令创建别名"}},[t._v("#")]),t._v(" 如何为node脚手架命令创建别名？")]),t._v(" "),s("p",[t._v("进入"),s("code",[t._v("/usr/local/bin")]),t._v("目录")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ln")]),t._v(" -s ./imooc-test-cai imooc-test-cai2\n")])])]),s("h4",{attrs:{id:"描述脚手架命令执行的全过程。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#描述脚手架命令执行的全过程。"}},[t._v("#")]),t._v(" 描述脚手架命令执行的全过程。")]),t._v(" "),s("h2",{attrs:{id:"脚手架开发流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架开发流程"}},[t._v("#")]),t._v(" 脚手架开发流程")]),t._v(" "),s("h3",{attrs:{id:"开发流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发流程"}},[t._v("#")]),t._v(" 开发流程")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("创建"),s("code",[t._v("npm")]),t._v("项目")])]),t._v(" "),s("li",[s("p",[t._v("创建脚手架入口文件，最上方添加：")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("#"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("env node\n")])])])]),t._v(" "),s("li",[s("p",[t._v("配置package.json，添加bin属性")])]),t._v(" "),s("li",[s("p",[t._v("编写脚手架代码")])]),t._v(" "),s("li",[s("p",[t._v("将脚手架发布到npm")])])]),t._v(" "),s("h3",{attrs:{id:"使用流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用流程"}},[t._v("#")]),t._v(" 使用流程")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("安装脚手架")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g your-own-cli\n")])])])]),t._v(" "),s("li",[s("p",[t._v("使用脚手架")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("your-own-cli\n")])])])])]),t._v(" "),s("h3",{attrs:{id:"脚手架开发难点解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架开发难点解析"}},[t._v("#")]),t._v(" 脚手架开发难点解析")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("分包：将复杂的系统拆分成若干个模块")])]),t._v(" "),s("li",[s("p",[t._v("命令注册：例")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vue create\nvue "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v("\nvue invoke\n")])])])]),t._v(" "),s("li",[s("p",[t._v("参数解析：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vue "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("ul",[s("li",[s("p",[t._v("options全称："),s("code",[t._v("--version")]),t._v("、"),s("code",[t._v("--help")])])]),t._v(" "),s("li",[s("p",[t._v("options简写："),s("code",[t._v("-V")]),t._v("、"),s("code",[t._v("-h")])])]),t._v(" "),s("li",[s("p",[t._v("带params的options："),s("code",[t._v("--path /Users/caimengxin/Desktop/vue-test")])])]),t._v(" "),s("li",[s("p",[t._v("帮助文档：")]),t._v(" "),s("ul",[s("li",[t._v("global help\n"),s("ul",[s("li",[t._v("Usage")]),t._v(" "),s("li",[t._v("Options")]),t._v(" "),s("li",[t._v("Commands")])])])]),t._v(" "),s("p",[t._v("示例："),s("code",[t._v("vue")]),t._v("的帮助信息：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("Usage: vue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nOptions:\n  -V, --version                              output the version number\n  -h, --help                                 output usage information\n\nCommands:\n  create "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("app-name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("                create a new project powered by vue-cli-service\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("plugin"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pluginOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("     "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" a plugin and invoke its generator "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an already created project\n  invoke "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("plugin"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pluginOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  invoke the generator of a plugin "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" an already created project\n  inspect "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("paths"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("               inspect the webpack config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" a project with vue-cli-service\n  serve "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                    serve a .js or .vue "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" development mode with zero config\n  build "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                    build a .js or .vue "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" production mode with zero config\n  ui "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                               start and "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),t._v(" the vue-cli ui\n  init "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("app-name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("       generate a project from a remote template "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("legacy API, requires @vue/cli-init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  config "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                   inspect and modify the config\n  outdated "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("experimental"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" check "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" outdated vue cli "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" / plugins\n  upgrade "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("plugin-name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("experimental"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" upgrade vue cli "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" / plugins\n  migrate "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("plugin-name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("experimental"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" run migrator "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" an already-installed cli plugin\n  info                                       print debugging information about your environment\n\n  Run vue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" --help "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" detailed usage of given command.\n\n")])])])])])])]),t._v(" "),s("p",[t._v("还有很多，比如：")]),t._v(" "),s("ul",[s("li",[t._v("命令行交互")]),t._v(" "),s("li",[t._v("日志打印")]),t._v(" "),s("li",[t._v("命令行文字变色")]),t._v(" "),s("li",[t._v("网络通信：HTTP、WebSocket")]),t._v(" "),s("li",[t._v("文件处理")])]),t._v(" "),s("p",[t._v("等等......")]),t._v(" "),s("h2",{attrs:{id:"脚手架本地link标准流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚手架本地link标准流程"}},[t._v("#")]),t._v(" 脚手架本地link标准流程")]),t._v(" "),s("p",[t._v("链接本地脚手架：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" your-cli-dir\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n")])])]),s("p",[t._v("链接本地库文件：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" your-lib-dir\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" your-cli-dir\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("link")]),t._v(" your-lib\n")])])]),s("p",[t._v("取消链接本地库文件：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" your-lib-dir\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" unlink\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" your-cli-dir\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link存在")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" unlink your-lib\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# link不存在")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf node_modules\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -S your-lib\n")])])]),s("p",[t._v("理解"),s("code",[t._v("npm unlink")]),t._v("：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("npm link your-lib")]),t._v("：将当前项目中的"),s("code",[t._v("node_modules")]),t._v("下指定的库文件链接到"),s("code",[t._v("node")]),t._v("全局"),s("code",[t._v("node_modules")]),t._v("下的库文件")]),t._v(" "),s("li",[s("code",[t._v("npm link")]),t._v("：将当前项目链接到"),s("code",[t._v("node")]),t._v("全局"),s("code",[t._v("node_modules")]),t._v("中作为一个库文件，并解析"),s("code",[t._v("bin")]),t._v("配置创建可执行文件")])]),t._v(" "),s("p",[t._v("理解"),s("code",[t._v("npm unlink")]),t._v("：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("npm unlink")]),t._v("：将当前项目从"),s("code",[t._v("node")]),t._v("全局"),s("code",[t._v("node_modules")]),t._v("中移除")]),t._v(" "),s("li",[s("code",[t._v("npm unlink your-lib")]),t._v("：将当前项目中的库文件依赖移除")])]),t._v(" "),s("h2",{attrs:{id:"原生脚手架开发痛点分析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原生脚手架开发痛点分析"}},[t._v("#")]),t._v(" 原生脚手架开发痛点分析")]),t._v(" "),s("ul",[s("li",[t._v("痛点一：重复操作\n"),s("ul",[s("li",[t._v("多Package本地link")]),t._v(" "),s("li",[t._v("多Package依赖安装")]),t._v(" "),s("li",[t._v("多Package单元测试")]),t._v(" "),s("li",[t._v("多Package代码提交")]),t._v(" "),s("li",[t._v("多Package代码发布")])])]),t._v(" "),s("li",[t._v("痛点二：版本一致性\n"),s("ul",[s("li",[t._v("发布时版本一致性")]),t._v(" "),s("li",[t._v("发布后相互依赖版本升级")])])])]),t._v(" "),s("p",[s("strong",[t._v("package越多，管理复杂度越高")])]),t._v(" "),s("h2",{attrs:{id:"lerna简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna简介"}},[t._v("#")]),t._v(" Lerna简介")]),t._v(" "),s("blockquote",[s("p",[t._v("Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.")])]),t._v(" "),s("p",[t._v("Lerna是一个优化基于git+npm的多package项目的管理工具")]),t._v(" "),s("h3",{attrs:{id:"优势"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优势"}},[t._v("#")]),t._v(" 优势")]),t._v(" "),s("ul",[s("li",[t._v("大幅减少重复操作")]),t._v(" "),s("li",[t._v("提升操作的标准化")])]),t._v(" "),s("blockquote",[s("p",[t._v("Lerna是架构优化的产物，它揭示了一个架构真理：项目复杂度提升后，就需要对项目进行架构优化。架构优化的主要目标往往都是以效能为核心。")])]),t._v(" "),s("h3",{attrs:{id:"官网"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#官网"}},[t._v("#")]),t._v(" 官网")]),t._v(" "),s("p",[t._v("官网：https://lerna.js.org/")]),t._v(" "),s("h3",{attrs:{id:"案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[t._v("#")]),t._v(" 案例")]),t._v(" "),s("p",[t._v("使用Lerna管理的大型项目：")]),t._v(" "),s("ul",[s("li",[t._v("babel：https://github.com/babel/babel")]),t._v(" "),s("li",[t._v("vue-cli：https://github.com/vuejs/vue-cli")]),t._v(" "),s("li",[t._v("create-react-app：https://github.com/facebook/create-react-app")])]),t._v(" "),s("h3",{attrs:{id:"lerna开发脚手架流程-重点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna开发脚手架流程-重点"}},[t._v("#")]),t._v(" lerna开发脚手架流程（重点）")]),t._v(" "),s("h3",{attrs:{id:"lern使用细节-重点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lern使用细节-重点"}},[t._v("#")]),t._v(" Lern使用细节（重点）")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("lerna init")]),t._v(":")]),t._v(" "),s("p",[t._v("会自动完成"),s("code",[t._v("git")]),t._v("初始化，但不会创建"),s("code",[t._v(".gitignore")]),t._v("文件，这个必须要手动添加，否则会将"),s("code",[t._v("node_modules")]),t._v("目录都上传到"),s("code",[t._v("git")]),t._v("，如果"),s("code",[t._v("node_modules")]),t._v("已经加入到"),s("code",[t._v("git stage")]),t._v("，可使用：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" reset HEAD "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("执行"),s("code",[t._v("unstage")]),t._v("操作，如果文件已经被"),s("code",[t._v("git")]),t._v("监听到变更，可使用：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" checkout -- "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("将变更作废，记得在执行操作之前将文件加入："),s("code",[t._v(".gitignore")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("lerna add")]),t._v("：")]),t._v(" "),s("ul",[s("li",[t._v("第一个参数：添加npm包名")]),t._v(" "),s("li",[t._v("第二个参数：本地package的路径")]),t._v(" "),s("li",[t._v("选项：\n"),s("ul",[s("li",[s("code",[t._v("--dev")]),t._v("：将依赖安装到"),s("code",[t._v("devDependencies")]),t._v("，不加时安装到"),s("code",[t._v("dependencies")])])])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("lerna "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("package"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("loc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --dev\n")])])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("lerna link")]),t._v("：")]),t._v(" "),s("p",[t._v("如果未发布上线，需要手动将依赖添加到"),s("code",[t._v("package.json")]),t._v("，再执行"),s("code",[t._v("npm link")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("lerna clean")]),t._v("：")]),t._v(" "),s("p",[t._v("只会删除"),s("code",[t._v("node_modules")]),t._v("，不会删除"),s("code",[t._v("package.json")]),t._v("中的依赖")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("lerna exec")]),t._v("和"),s("code",[t._v("lerna run")]),t._v("：")]),t._v(" "),s("p",[s("code",[t._v("--scope")]),t._v("属性后添加的是包名，而不是"),s("code",[t._v("package")]),t._v("的路径，这点和"),s("code",[t._v("lerna add")]),t._v("用法不同")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("lerna publish")])]),t._v(" "),s("ul",[s("li",[t._v("发布时会自动执行："),s("code",[t._v("git add package-lock.json")]),t._v("，所以package-lock.json不要加入"),s("code",[t._v(".gitignore")]),t._v("文件")]),t._v(" "),s("li",[t._v("先创建远程仓库，并且同步一次master分支")]),t._v(" "),s("li",[t._v("执行"),s("code",[t._v("lerna publish")]),t._v("前先完成"),s("code",[t._v("npm login")])]),t._v(" "),s("li",[t._v("如果发布的npm包名为："),s("code",[t._v("@xxx/yyy")]),t._v("的格式，需要先在npm注册名为：xxx的organization，否则可能会提交不成功")]),t._v(" "),s("li",[t._v("发布到"),s("code",[t._v("npm group")]),t._v("时默认为private，所以我们需要手动在"),s("code",[t._v("package.json")]),t._v("中添加如下设置")])])])]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"publishConfig"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"access"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"public"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"yargs使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yargs使用"}},[t._v("#")]),t._v(" yargs使用")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("#"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("usr"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("bin"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("env node\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" yargs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'yargs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dedent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dedent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pkg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../package.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cli "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("yargs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" argv "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("slice")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" context "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  imoocVersion"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" pkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("version\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\ncli\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 第一行的使用提示")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("usage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Usage: imooc-cli-cai [command] <options>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 提示用户脚手架最少要接收一个命令")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("demandCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'A command is required. Pass --help to see all available commands and options.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 命令输入错误或者没有此命令的时候可以根据输入推荐合适的命令")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("recommendCommands")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 命令错误时执行的方法")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fail")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 help和version的别名")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alias")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'version'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alias")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'help'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 终端宽度")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cli"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("terminalWidth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 尾部的提示文字")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("epilogue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dedent"),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n      when a command fails,all logs are written to lerna-debug.log in the current working directory.\n\n      For more information,find our manual at https://github.com/lerna/lerna\n    ")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 debug命令")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      debug"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"boolean"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        describe"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Bootstrap debug mode"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 registry命令")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'registry'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"string"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      describe"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Define global registry"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 分组")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'debug'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Dev Options'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'registry'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Extra Options'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 命令，当执行 init [name] 命令的时候一系列的行为")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'init [name]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Do init a project'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("yargs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      yargs\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'string'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          describe"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Name of a project'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          alias"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'n'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("argv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 命令的第二种方法")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      command"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      aliases"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ls'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ll'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'la'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      describe"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'List local packages'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("builder")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("yargs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handler")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("argv")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置 严格模式，最后一行提示命令错误，如：无法识别的选项：lis")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("strict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 解析参数")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("argv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"lerna原理-还未深入理解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna原理-还未深入理解"}},[t._v("#")]),t._v(" lerna原理（还未深入理解）")]),t._v(" "),s("ul",[s("li",[t._v("通过import-local来优先调用本地lerna命令")]),t._v(" "),s("li",[t._v("通过Yargs初始化脚手架，然后注册全局属性，再注册命令，最后通过parse方法解析参数")]),t._v(" "),s("li",[t._v("lerna命令注册时需要传入build和handler两个函数，build用来注册命令专属的options，handler用来处理命令的业务逻辑")]),t._v(" "),s("li",[t._v("lerna通过配置npm本地依赖的方式进行本地开发，具体写法是在package.json中写入：file:your-locale-module-path,在lerna publish的时候会自动替换路径")])])])}),[],!1,null,null,null);a.default=e.exports}}]);