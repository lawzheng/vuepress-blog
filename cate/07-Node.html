<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>express | Lawz&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/vuepress-blog/logo.jpg">
    <meta name="description" content="罗政的个人博客">
    
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.db36d651.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.666c71c1.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.b3a7e8a2.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/1.adc2a77f.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/124.7708ef5d.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.5892f9ff.js"><link rel="prefetch" href="/vuepress-blog/assets/js/100.544f750c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/101.75bf87b5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/102.53458609.js"><link rel="prefetch" href="/vuepress-blog/assets/js/103.f42c3c15.js"><link rel="prefetch" href="/vuepress-blog/assets/js/104.a411c1f1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/105.023d546c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/106.7103db90.js"><link rel="prefetch" href="/vuepress-blog/assets/js/107.0c2ede53.js"><link rel="prefetch" href="/vuepress-blog/assets/js/108.b4a45977.js"><link rel="prefetch" href="/vuepress-blog/assets/js/109.beeef11c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.c262e13e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/110.0f78806b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/111.3b87a805.js"><link rel="prefetch" href="/vuepress-blog/assets/js/112.f6b00b86.js"><link rel="prefetch" href="/vuepress-blog/assets/js/113.dfddbeef.js"><link rel="prefetch" href="/vuepress-blog/assets/js/114.d50dc4aa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/115.144a58b8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/116.8329cffa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/117.38e1b8aa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/118.f5bbaa4b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/119.5e7d7c31.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.3d3334a8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/120.197a92db.js"><link rel="prefetch" href="/vuepress-blog/assets/js/121.1119ba1f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/122.529946c6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/123.d9473d70.js"><link rel="prefetch" href="/vuepress-blog/assets/js/125.903c1cac.js"><link rel="prefetch" href="/vuepress-blog/assets/js/126.a88c4dd1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/127.5da9d333.js"><link rel="prefetch" href="/vuepress-blog/assets/js/128.f3f3e638.js"><link rel="prefetch" href="/vuepress-blog/assets/js/129.63648f6a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.96eefecf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/130.d302f28e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/131.e70ef6ee.js"><link rel="prefetch" href="/vuepress-blog/assets/js/132.1001dd91.js"><link rel="prefetch" href="/vuepress-blog/assets/js/133.8007f2f2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/134.db2183ee.js"><link rel="prefetch" href="/vuepress-blog/assets/js/135.c0c61c6b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/136.561f9935.js"><link rel="prefetch" href="/vuepress-blog/assets/js/137.8af547d2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/138.0a7ccafe.js"><link rel="prefetch" href="/vuepress-blog/assets/js/139.83fbb6e0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.ff02afa3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/140.d331daf0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/141.3942baa4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/142.7aceea34.js"><link rel="prefetch" href="/vuepress-blog/assets/js/143.5b3fff9e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/144.ada36f90.js"><link rel="prefetch" href="/vuepress-blog/assets/js/145.fdca595c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/146.0cee8ebc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/147.5e1d844b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/148.d5e2d262.js"><link rel="prefetch" href="/vuepress-blog/assets/js/149.d5dbd2ab.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.60287a3a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/150.6d343279.js"><link rel="prefetch" href="/vuepress-blog/assets/js/151.82211e6c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/152.685db695.js"><link rel="prefetch" href="/vuepress-blog/assets/js/153.537b28db.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.03325ede.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.ec0a2aed.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.26eec4a3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.2f62a01c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.7773e6b5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.c8f266e5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.d6fc5cc5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.4909d2b8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.5b2af4fa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.2ba01263.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.cfd34404.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.56ff9ca3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.9735f3fd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.359b14a5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/3.c920d9b6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.5ae8b837.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.a97e70f3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.6f3bcada.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.ef91c9d4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.989d3839.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.ec52f8ee.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.867cb360.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.5c9aaba2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.f9b685cc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.e24cc907.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.1bfcb566.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.1bf7e3aa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.8dc6b65f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.ef5ec161.js"><link rel="prefetch" href="/vuepress-blog/assets/js/43.88350869.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.b49e3027.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.112cd38b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.c0a90dc2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.6a44cb32.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.6074b286.js"><link rel="prefetch" href="/vuepress-blog/assets/js/49.bf4aac86.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.2e5bb951.js"><link rel="prefetch" href="/vuepress-blog/assets/js/50.6e137038.js"><link rel="prefetch" href="/vuepress-blog/assets/js/51.9290b1a7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/52.f5521f2a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/53.76b0a355.js"><link rel="prefetch" href="/vuepress-blog/assets/js/54.94f9c5bf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/55.94509738.js"><link rel="prefetch" href="/vuepress-blog/assets/js/56.9c0e3285.js"><link rel="prefetch" href="/vuepress-blog/assets/js/57.54e8a610.js"><link rel="prefetch" href="/vuepress-blog/assets/js/58.4bdc6924.js"><link rel="prefetch" href="/vuepress-blog/assets/js/59.9bcc0733.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.1fbe6543.js"><link rel="prefetch" href="/vuepress-blog/assets/js/60.2769fbc3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/61.c2a9a718.js"><link rel="prefetch" href="/vuepress-blog/assets/js/62.8202151d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/63.d1da8349.js"><link rel="prefetch" href="/vuepress-blog/assets/js/64.b0743f1f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/65.da132de9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/66.dc890194.js"><link rel="prefetch" href="/vuepress-blog/assets/js/67.5f52c943.js"><link rel="prefetch" href="/vuepress-blog/assets/js/68.02c1cb95.js"><link rel="prefetch" href="/vuepress-blog/assets/js/69.e5201224.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.b36d3dc4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/70.9ad44931.js"><link rel="prefetch" href="/vuepress-blog/assets/js/71.0b61cbe6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/72.e09f3393.js"><link rel="prefetch" href="/vuepress-blog/assets/js/73.cce225b0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/74.eebff028.js"><link rel="prefetch" href="/vuepress-blog/assets/js/75.9129fe3c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/76.043cfe3b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/77.c8ed6079.js"><link rel="prefetch" href="/vuepress-blog/assets/js/78.c113e822.js"><link rel="prefetch" href="/vuepress-blog/assets/js/79.6d34deff.js"><link rel="prefetch" href="/vuepress-blog/assets/js/80.ecf0f4ca.js"><link rel="prefetch" href="/vuepress-blog/assets/js/81.e7460b65.js"><link rel="prefetch" href="/vuepress-blog/assets/js/82.45a08bbf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/83.89b3a033.js"><link rel="prefetch" href="/vuepress-blog/assets/js/84.acda26e3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/85.c58278bf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/86.d081c19c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/87.f5cb4c99.js"><link rel="prefetch" href="/vuepress-blog/assets/js/88.d7ea8dcf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/89.ea0f8f74.js"><link rel="prefetch" href="/vuepress-blog/assets/js/90.6819ab97.js"><link rel="prefetch" href="/vuepress-blog/assets/js/91.034f334c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/92.324265be.js"><link rel="prefetch" href="/vuepress-blog/assets/js/93.cb942925.js"><link rel="prefetch" href="/vuepress-blog/assets/js/94.f30400c4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/95.1ed7d331.js"><link rel="prefetch" href="/vuepress-blog/assets/js/96.4ce6d4f4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/97.5e1f6c12.js"><link rel="prefetch" href="/vuepress-blog/assets/js/98.95443e49.js"><link rel="prefetch" href="/vuepress-blog/assets/js/99.ecee2976.js"><link rel="prefetch" href="/vuepress-blog/assets/js/vendors~docsearch.969bac05.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.db36d651.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><!----> <span class="site-name">Lawz's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/blog/2025-04-22 支持一键放大组件.html" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识分类" class="dropdown-title"><span class="title">知识分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="知识分类" class="mobile-dropdown-title"><span class="title">知识分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/01-Html.html" class="nav-link">
  Html
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/02-Css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/03-Js.html" class="nav-link">
  Js
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/04-Browser.html" class="nav-link">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/05-Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/06-React.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/07-Node.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/08-RegEx.html" class="nav-link">
  RegEx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/09-IDE.html" class="nav-link">
  IDE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/10-算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/11-Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/12-Nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/13-Typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/14-webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/15-小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/16-Hybird.html" class="nav-link">
  Hybird
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/17-安全.html" class="nav-link">
  安全
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/18-面试.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/19-网络.html" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/20-知识回顾.html" class="nav-link">
  知识回顾
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/21-React-Native.html" class="nav-link">
  React Native
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/book/2021-03-28 香帅财富报告.html" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="nav-link">
  web架构师
</a></div><div class="nav-item"><a href="https://github.com/lawzheng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/blog/2025-04-22 支持一键放大组件.html" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识分类" class="dropdown-title"><span class="title">知识分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="知识分类" class="mobile-dropdown-title"><span class="title">知识分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/01-Html.html" class="nav-link">
  Html
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/02-Css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/03-Js.html" class="nav-link">
  Js
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/04-Browser.html" class="nav-link">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/05-Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/06-React.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/07-Node.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/08-RegEx.html" class="nav-link">
  RegEx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/09-IDE.html" class="nav-link">
  IDE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/10-算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/11-Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/12-Nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/13-Typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/14-webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/15-小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/16-Hybird.html" class="nav-link">
  Hybird
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/17-安全.html" class="nav-link">
  安全
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/18-面试.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/19-网络.html" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/20-知识回顾.html" class="nav-link">
  知识回顾
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/21-React-Native.html" class="nav-link">
  React Native
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/book/2021-03-28 香帅财富报告.html" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="nav-link">
  web架构师
</a></div><div class="nav-item"><a href="https://github.com/lawzheng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>express</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/cate/07-Node.html#深入nodejs" class="sidebar-link">深入nodejs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#石头剪刀布" class="sidebar-link">石头剪刀布</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#event" class="sidebar-link">event</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#非阻塞io" class="sidebar-link">非阻塞io</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#异步编程" class="sidebar-link">异步编程</a></li></ul></li><li><a href="/vuepress-blog/cate/07-Node.html#egg-js" class="sidebar-link">egg.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#启动" class="sidebar-link">启动</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#配置插件" class="sidebar-link">配置插件</a></li></ul></li><li><a href="/vuepress-blog/cate/07-Node.html#开课吧node" class="sidebar-link">开课吧node</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/07-Node.html#第三方插件" class="sidebar-link">第三方插件</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h4 id="express"><a href="#express" class="header-anchor">#</a> express</h4> <div class="language- extra-class"><pre class="language-text"><code>npm i express-generator -g

express 文件夹名

切进去 npm i
</code></pre></div><h4 id="nvm"><a href="#nvm" class="header-anchor">#</a> nvm</h4> <p>下载 开代理</p> <p>https://github.com/coreybutler/nvm-windows/releases</p> <p>使用</p> <p>https://www.jianshu.com/p/d0e0935b150a</p> <p>速度慢</p> <p>https://www.jianshu.com/p/0e4f2bfadf3e</p> <h4 id="npm"><a href="#npm" class="header-anchor">#</a> npm</h4> <p>npm login</p> <p>npm publish</p> <h3 id="http-https-协议"><a href="#http-https-协议" class="header-anchor">#</a> http/https 协议</h3> <ul><li>1.0 协议缺陷:
<ul><li>无法复用链接，完成即断开，<strong>重新慢启动和 TCP 3次握手</strong></li> <li>head of line blocking: <strong>线头阻塞</strong>，导致请求之间互相影响</li></ul></li> <li>1.1 改进:
<ul><li><strong>长连接</strong>(默认 keep-alive)，复用</li> <li>host 字段指定对应的虚拟站点</li> <li>新增功能:
<ul><li>断点续传</li> <li>身份认证</li> <li>状态管理</li> <li>cache 缓存
<ul><li>Cache-Control</li> <li>Expires</li> <li>Last-Modified</li> <li>Etag</li></ul></li></ul></li></ul></li> <li>2.0:
<ul><li>多路复用</li> <li>二进制分帧层: 应用层和传输层之间</li> <li>首部压缩</li> <li>服务端推送</li></ul></li> <li>https: 较为安全的网络传输协议
<ul><li>证书(公钥)</li> <li>SSL 加密</li> <li>端口 443</li></ul></li> <li>TCP:
<ul><li>三次握手</li> <li>四次挥手</li> <li>滑动窗口: 流量控制</li> <li>拥塞处理
<ul><li>慢开始</li> <li>拥塞避免</li> <li>快速重传</li> <li>快速恢复</li></ul></li></ul></li> <li>缓存策略: 可分为 <strong>强缓存</strong> 和 <strong>协商缓存</strong> <ul><li>Cache-Control/Expires: 浏览器判断缓存是否过期，未过期时，直接使用强缓存，<strong>Cache-Control的 max-age 优先级高于 Expires</strong></li> <li>当缓存已经过期时，使用协商缓存
<ul><li>唯一标识方案: Etag(response 携带) &amp; If-None-Match(request携带，上一次返回的 Etag): 服务器判断资源是否被修改，</li> <li>最后一次修改时间: Last-Modified(response) &amp; If-Modified-Since (request，上一次返回的Last-Modified)
<ul><li>如果一致，则直接返回 304 通知浏览器使用缓存</li> <li>如不一致，则服务端返回新的资源</li></ul></li></ul></li> <li>Last-Modified 缺点：
<ul><li>周期性修改，但内容未变时，会导致缓存失效</li> <li>最小粒度只到 s， s 以内的改动无法检测到</li></ul></li> <li>Etag 的优先级高于 Last-Modified</li></ul></li></ul> <h3 id="常见状态码"><a href="#常见状态码" class="header-anchor">#</a> 常见状态码</h3> <ul><li>1xx: 接受，继续处理</li> <li>200: 成功，并返回数据</li> <li>201: 已创建</li> <li>202: 已接受</li> <li>203: 成为，但未授权</li> <li>204: 成功，无内容</li> <li>205: 成功，重置内容</li> <li>206: 成功，部分内容</li> <li>301: 永久移动，重定向</li> <li>302: 临时移动，可使用原有URI</li> <li>304: 资源未修改，可使用缓存</li> <li>305: 需代理访问</li> <li>400: 请求语法错误</li> <li>401: 要求身份认证</li> <li>403: 拒绝请求</li> <li>404: 资源不存在</li> <li>500: 服务器错误</li></ul> <h3 id="get-post"><a href="#get-post" class="header-anchor">#</a> get / post</h3> <ul><li>get: 缓存、请求长度受限、会被历史保存记录
<ul><li>无副作用(不修改资源)，幂等(请求次数与资源无关)的场景</li></ul></li> <li>post: 安全、大数据、更多编码类型</li></ul> <p>两者详细对比如下图:</p> <p><img src="https://user-gold-cdn.xitu.io/2019/2/14/168e9d9050b9d08a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <h3 id="websocket"><a href="#websocket" class="header-anchor">#</a> Websocket</h3> <p>Websocket 是一个 <strong>持久化的协议</strong>， 基于 http ， 服务端可以 <strong>主动 push</strong></p> <ul><li>兼容：
<ul><li>FLASH Socket</li> <li>长轮询： 定时发送 ajax</li> <li>long poll： 发送 --&gt; 有消息时再 response</li></ul></li> <li><code>new WebSocket(url)</code></li> <li><code>ws.onerror = fn</code></li> <li><code>ws.onclose = fn</code></li> <li><code>ws.onopen = fn</code></li> <li><code>ws.onmessage = fn</code></li> <li><code>ws.send()</code></li></ul> <h3 id="tcp三次握手"><a href="#tcp三次握手" class="header-anchor">#</a> TCP三次握手</h3> <p>建立连接前，客户端和服务端需要通过握手来确认对方:</p> <ul><li>客户端发送 syn(同步序列编号) 请求，进入 syn_send 状态，等待确认</li> <li>服务端接收并确认 syn 包后发送 syn+ack 包，进入 syn_recv 状态</li> <li>客户端接收 syn+ack 包后，发送 ack 包，双方进入 established 状态</li></ul> <h3 id="tcp四次挥手"><a href="#tcp四次挥手" class="header-anchor">#</a> TCP四次挥手</h3> <ul><li>客户端 -- FIN --&gt; 服务端， FIN—WAIT</li> <li>服务端 -- ACK --&gt; 客户端， CLOSE-WAIT</li> <li>服务端 -- ACK,FIN --&gt; 客户端， LAST-ACK</li> <li>客户端 -- ACK --&gt; 服务端，CLOSED</li></ul> <h3 id="node-的-event-loop-6个阶段"><a href="#node-的-event-loop-6个阶段" class="header-anchor">#</a> Node 的 Event Loop: 6个阶段</h3> <ul><li><p>timer 阶段: 执行到期的<code>setTimeout / setInterval</code>队列回调</p></li> <li><p>I/O 阶段: 执行上轮循环残流的<code>callback</code></p></li> <li><p>idle, prepare</p></li> <li><p>poll: 等待回调</p> <ul><li><ol><li>执行回调</li></ol></li> <li><ol><li>执行定时器</li></ol> <ul><li>如有到期的<code>setTimeout / setInterval</code>， 则返回 timer 阶段</li> <li>如有<code>setImmediate</code>，则前往 check 阶段</li></ul></li></ul></li> <li><p>check</p> <ul><li>执行<code>setImmediate</code></li></ul></li> <li><p>close callbacks</p></li></ul> <h3 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h3> <ul><li>JSONP: 利用``标签不受跨域限制的特点，缺点是只能支持 get 请求</li></ul> <div class="language- extra-class"><pre class="language-text"><code>function jsonp(url, jsonpCallback, success) {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.type = 'text/javascript'
  window[jsonpCallback] = function(data) {
    success &amp;&amp; success(data)
  }
  document.body.appendChild(script)
}
复制代码
</code></pre></div><ul><li>设置 CORS: Access-Control-Allow-Origin：*</li> <li>postMessage</li></ul> <h3 id="安全"><a href="#安全" class="header-anchor">#</a> 安全</h3> <ul><li>XSS攻击: 注入恶意代码
<ul><li>cookie 设置 httpOnly</li> <li>转义页面上的输入内容和输出内容</li></ul></li> <li>CSRF: 跨站请求伪造，防护:
<ul><li>get 不修改数据</li> <li>不被第三方网站访问到用户的 cookie</li> <li>设置白名单，不被第三方网站请求</li> <li>请求校验</li></ul></li></ul> <h3 id="common-js-导出and接收"><a href="#common-js-导出and接收" class="header-anchor">#</a> Common.js 导出and接收</h3> <h4 id="单个情况"><a href="#单个情况" class="header-anchor">#</a> 单个情况</h4> <div class="language- extra-class"><pre class="language-text"><code>function add(a, b) {
    return a + b
}

module.exports = add

const add = require(./a)
</code></pre></div><h4 id="多个情况"><a href="#多个情况" class="header-anchor">#</a> 多个情况</h4> <div class="language- extra-class"><pre class="language-text"><code>function add(a, b) {
    return a + b
}
function mul(a, b) {
    return a * b
}

module.exports = {
    mul,
    add
}

const {add, mul} = require('./a')
</code></pre></div><h3 id="lodash"><a href="#lodash" class="header-anchor">#</a> lodash</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i lodash

const _ = require('lodash')
</code></pre></div><h3 id="输入url"><a href="#输入url" class="header-anchor">#</a> 输入url</h3> <h4 id="dns解析"><a href="#dns解析" class="header-anchor">#</a> dns解析</h4> <p>https端口443 http80</p> <h4 id="建立tcp连接"><a href="#建立tcp连接" class="header-anchor">#</a> 建立tcp连接</h4> <p>三次握手</p> <p>客户端询问服务器是否可以用</p> <p>告诉可用</p> <p>发送请求</p> <h4 id="发送http请求"><a href="#发送http请求" class="header-anchor">#</a> 发送http请求</h4> <p>发送请求头</p> <h4 id="server接到http请求-处理-返回"><a href="#server接到http请求-处理-返回" class="header-anchor">#</a> server接到http请求，处理，返回</h4> <p>返回响应头</p> <h4 id="接收到返回的数据-处理数据-渲染页面-执行js"><a href="#接收到返回的数据-处理数据-渲染页面-执行js" class="header-anchor">#</a> 接收到返回的数据 处理数据（渲染页面，执行js）</h4> <h3 id="node最简"><a href="#node最简" class="header-anchor">#</a> node最简</h3> <div class="language- extra-class"><pre class="language-text"><code>const http = require('http')

const server = http.createServer((req, res) =&gt; {
    res.writeHead(200, {'content-type': 'text/html'})
    res.end('&lt;h1&gt;hello world&lt;/h1&gt;')
})

server.listen(3000, () =&gt; {
    console.log('listening on 3000 port')
})
</code></pre></div><h3 id="处理get请求"><a href="#处理get请求" class="header-anchor">#</a> 处理get请求</h3> <div class="language- extra-class"><pre class="language-text"><code>const http = require('http')
const querystring = require('querystring') // querystring小写

const server = http.createServer((req, res) =&gt; {
    console.log(req.method)
    const url = req.url
    console.log(url)
    //    /api/blog/list?id=1&amp;e=2
    req.query = querystring.parse(url.split('?')[1])
    res.end(JSON.stringify(req.query))
    //   {&quot;id&quot;:&quot;1&quot;,&quot;e&quot;:&quot;2&quot;}
})

server.listen(3000, () =&gt; {
    console.log('listening on 3000 port')
})
</code></pre></div><h3 id="处理post"><a href="#处理post" class="header-anchor">#</a> 处理post</h3> <div class="language- extra-class"><pre class="language-text"><code>const http = require('http')
const server = http.createServer((req, res) =&gt; {
    if (req.method = 'POST') {
        console.log('content-type', req.headers['content-type'])
        let postData = ''
        req.on('data', chunk =&gt; {
            postData += chunk.toString()
        })
        req.on('end', () =&gt; {
            console.log('postData', postData)
            res.end('hello world')
        })
    }
})
server.listen(3000, () =&gt; {
    console.log('3000')
})
</code></pre></div><h4 id="postman"><a href="#postman" class="header-anchor">#</a> postman</h4> <p>crx改为zip</p> <p>安装</p> <p>chrome://apps 打开</p> <h3 id="完整实例"><a href="#完整实例" class="header-anchor">#</a> 完整实例</h3> <div class="language- extra-class"><pre class="language-text"><code>const http = require('http')
const querystring = require('querystring')

const server = http.createServer((req, res) =&gt; {
    const method = req.method
    const url = req.url
    const path = url.split('?')[0]
    const query = querystring.parse(url.split('?')[1])

    res.setHeader('content-type', 'application/json')
    const resData = {
        method,
        url,
        path,
        query
    }

    if (method === 'GET') {
        res.end(JSON.stringify(resData))
    }
    if (method === 'POST') {
        let postData = ''
        req.on('data', chunk =&gt; {
            postData += chunk.toString()
        })
        req.on('end', () =&gt; {
            resData.postData = postData
            res.end(JSON.stringify(resData))
        })
    }
})
server.listen(3000, () =&gt; {
    console.log('ok')
})
</code></pre></div><h3 id="博客接口"><a href="#博客接口" class="header-anchor">#</a> 博客接口</h3> <p><img src="C:%5CUsers%5C602285510%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1565437967548.png" alt="1565437967548"></p> <h3 id="vscode"><a href="#vscode" class="header-anchor">#</a> vscode</h3> <h4 id="选中所有一样的"><a href="#选中所有一样的" class="header-anchor">#</a> 选中所有一样的</h4> <p>ctrl shift L</p> <h4 id="选择单个一样的"><a href="#选择单个一样的" class="header-anchor">#</a> 选择单个一样的</h4> <p>ctrl d</p> <h4 id="格式化"><a href="#格式化" class="header-anchor">#</a> 格式化</h4> <p>alt shift f</p> <h4 id="控制台"><a href="#控制台" class="header-anchor">#</a> 控制台</h4> <p>CTRL `</p> <h3 id="nodemon"><a href="#nodemon" class="header-anchor">#</a> nodemon</h3> <div class="language- extra-class"><pre class="language-text"><code>npm install -g nodemon
</code></pre></div><p>全局安装 不然报错</p> <h3 id="cross-env"><a href="#cross-env" class="header-anchor">#</a> cross-env</h3> <p>用这个加环境标志</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;dev&quot;: &quot;cross-env NODE_ENV=dev nodemon ./bin/www.js&quot;,
&quot;prd&quot;: &quot;cross-env NODE_ENV=production nodemon ./bin/www.js&quot;
</code></pre></div><h3 id="路由-api区别"><a href="#路由-api区别" class="header-anchor">#</a> 路由 api区别</h3> <h4 id="api"><a href="#api" class="header-anchor">#</a> api</h4> <p>前端后端、不同端之间对接的一个术语</p> <h4 id="路由"><a href="#路由" class="header-anchor">#</a> 路由</h4> <p>api的一部分</p> <p>后端系统内部的一个模块</p> <h3 id="mysql"><a href="#mysql" class="header-anchor">#</a> mysql</h3> <p>下载</p> <p>https://dev.mysql.com/downloads/mysql/</p> <p>root</p> <p>root</p> <h4 id="workbench"><a href="#workbench" class="header-anchor">#</a> workbench</h4> <p>点击圆柱体建库</p> <p>工具内建表</p> <h4 id="显示数据库"><a href="#显示数据库" class="header-anchor">#</a> 显示数据库</h4> <div class="language- extra-class"><pre class="language-text"><code>show databases;
</code></pre></div><h4 id="sql语句"><a href="#sql语句" class="header-anchor">#</a> sql语句</h4> <div class="language- extra-class"><pre class="language-text"><code>use myblog; --切到这个库
-- show tables; -- 显示所有表

--增
-- insert into users (username,`password`,realname) values ('lisi', '123', '李四');

--查  &lt;&gt;不等
-- select * from users where state &lt;&gt; '0';
-- select id,username from users;

-- select * from users where username = 'zhangsan' and `password` = '123';

-- select * from users where username like '%li%';

-- desc倒序 ，不加就正序  id从小到大
-- select * from users where password like '%1%' order by id desc;

-- 改  多个用逗号分开 被安全模式限制
-- update users set username = 'lzz', realname = '罗政' where id = 2;

-- 取消安全限制
-- SET SQL_SAFE_UPDATES = 0

-- 删
-- delete from users where username = 'lisi';

-- 一般只是软删除 将状态改变
-- update users set state = '0' where id = '1';		-- 软删除

-- select * from users where state &lt;&gt; '0';


-- insert into blogs (title, content, createtime, author) values ('标题b', '内容a', 1565495745124, 'lz');

-- select * from blogs;

-- 查版本号
-- select version();

-- verchart(10) 不区分英文汉字了 mysql &gt;= 5

</code></pre></div><p>524ab85686df0e52ada43b11b53cce35</p> <h3 id="node连接mysql"><a href="#node连接mysql" class="header-anchor">#</a> node连接mysql</h3> <h4 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h4> <div class="language- extra-class"><pre class="language-text"><code>npm i mysql

const mysql = require('mysql')

// 创建链接对象
const con = mysql.createConnection({
    host: 'localhost',
    user: 'root',
    password: 'root',
    port: '3306',
    database: 'myblog'
})

// 连接
con.connect()

const sql = 'select * from users;'
con.query(sql, (err, result) =&gt; {
    if (err) {
        console.log(err)
        return
    }
    console.log(result)
})

con.end() 

</code></pre></div><h3 id="命令行连接mysql"><a href="#命令行连接mysql" class="header-anchor">#</a> 命令行连接mysql</h3> <div class="language- extra-class"><pre class="language-text"><code>mysql -u用户名 -p

回车之后输入正确的密码即可进入mysql
</code></pre></div><h3 id="nodejs连mysql报错1251"><a href="#nodejs连mysql报错1251" class="header-anchor">#</a> nodejs连mysql报错1251</h3> <div class="language- extra-class"><pre class="language-text"><code>ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'root';
</code></pre></div><p>这行代码有两层含义，第一:修改root的密码为'root'，摒弃原来的旧密码。第二：使用mysql_native_password对新密码进行编码。</p> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h3> <p>存储在浏览器的一段字符串（最大5kb）</p> <p>跨域不共享</p> <p>每次发http请求都会带上cookie</p> <p>server可以修改并返回给浏览器 可以限制浏览器更改</p> <p>document.cookie = 'k1=100;'   累加</p> <h3 id="redis"><a href="#redis" class="header-anchor">#</a> redis</h3> <h4 id="安装-2"><a href="#安装-2" class="header-anchor">#</a> 安装</h4> <div class="language- extra-class"><pre class="language-text"><code>https://www.runoob.com/redis/redis-install.html
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>redis-cli		// 进入

set key value

get key

del key

keys *   // 看全部

</code></pre></div><h4 id="node中使用"><a href="#node中使用" class="header-anchor">#</a> node中使用</h4> <div class="language- extra-class"><pre class="language-text"><code>npm i redis
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>const redis = require('redis')
const {REDIS_CONF} = require('../../conf/db')

// 创建客户端
const redisClient = redis.createClient(REDIS_CONF.port, REDIS_CONF.host)
redisClient.on('error', error =&gt; {
    console.error(error)
})

redisClient.set('myname', 'lzz', redis.print)
redisClient.get('myname', (err, val) =&gt; {
    if (err) {
        console.error(err)
        return
    }
    console.log('val', val)

    // 退出
    redisClient.quit()
})
</code></pre></div><h3 id="nginx"><a href="#nginx" class="header-anchor">#</a> nginx</h3> <h4 id="下载"><a href="#下载" class="header-anchor">#</a> 下载</h4> <div class="language- extra-class"><pre class="language-text"><code>http://nginx.org/en/download.html
</code></pre></div><p>点击exe启动  在localhost就能看到 没有端口号</p> <h4 id="改配置-nginx-conf"><a href="#改配置-nginx-conf" class="header-anchor">#</a> 改配置 nginx.conf</h4> <div class="language- extra-class"><pre class="language-text"><code>worker_processes: 2;
listen       8080;
</code></pre></div><h4 id="改代理"><a href="#改代理" class="header-anchor">#</a> 改代理</h4> <div class="language- extra-class"><pre class="language-text"><code>location / {
            proxy_pass: http://localhost:8001;
        }
location /api/ {
            proxy_pass: http://localhost:8000;
            proxy_set_header Host $host;
}
</code></pre></div><h3 id="node操作文件"><a href="#node操作文件" class="header-anchor">#</a> node操作文件</h3> <div class="language- extra-class"><pre class="language-text"><code>const fs = require('fs')
const path = require('path')

const fileName = path.resolve(__dirname, 'data.txt')

fs.readFile(fileName, (err, data) =&gt; {
    if (err) {
        console.error(err)
        return
    }
    // data是二进制
    console.log(data.toString())
})

// 写入
const content = 'haha\n'
const opt = {
    flag: 'a'       // 追加写入 覆盖 是 w
}
fs.writeFile(fileName, content, opt, (err) =&gt; {
    if (err) {
        console.error(err)
    }
})

// 判断存在
fs.exists(fileName, (exist) =&gt; {
    console.log(exist)
})
</code></pre></div><h3 id="stream"><a href="#stream" class="header-anchor">#</a> stream</h3> <div class="language- extra-class"><pre class="language-text"><code>// 标准输入输出
process.stdin.pipe(process.stdout)

const http = require('http')
const server = http.createServer((req, res) =&gt; {
    if (req.method === 'POST') {
        req.pipe(res)
    }
})
server.listen(7000, () =&gt; {
    console.log(7000)
})
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// 复制文件
const fs = require('fs')
const path = require('path')

const fileName1 = path.resolve(__dirname, 'data.txt')
const fileName2 = path.resolve(__dirname, 'data-bak.txt')

const readStream = fs.createReadStream(fileName1)
const writeStream = fs.createWriteStream(fileName2)

readStream.pipe(writeStream)
readStream.on('data', (chunk) =&gt; {
    console.log('oooooooooo')
})
readStream.on('end', () =&gt; {
    console.log('copy done')
})
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>// 访问网络
const http = require('http')
const fs = require('fs')
const path = require('path')

const fileName1 = path.resolve(__dirname, 'data.txt')

const server = http.createServer((req, res) =&gt; {
    if (req.method === 'GET') {
        const readStream = fs.createReadStream(fileName1)
        readStream.pipe(res)
    }
})
server.listen(7000, () =&gt; {
    console.log(7000)
})
</code></pre></div><h3 id="readline"><a href="#readline" class="header-anchor">#</a> readline</h3> <div class="language- extra-class"><pre class="language-text"><code>const fs = require('fs')
const path = require('path')
const readline = require('readline')

const fileName = path.join(__dirname, '../', '../', 'logs', 'access.log')

// 创建 readStream
const readStream = fs.createReadStream(fileName)

// 创建readline对象
const rl = readline.createInterface({
    input: readStream
})

let chromeNum = 0
let num = 0

// 逐行读取
rl.on('line', (lineData) =&gt; {
    if (!lineData) {
        return
    }

    num++

    const arr = lineData.split(' -- ')
    if (arr[2] &amp;&amp; arr[2].indexOf('Chrome') &gt; 0) {
        chromeNum++
    }
})

rl.on('close', () =&gt; {
    console.log('chrome占比', chromeNum / num * 100 + '%')
})
</code></pre></div><h3 id="sql注入"><a href="#sql注入" class="header-anchor">#</a> sql注入</h3> <p>lzz' -- ' 密码乱输就能登陆上</p> <h4 id="防止办法"><a href="#防止办法" class="header-anchor">#</a> 防止办法</h4> <p>escape</p> <div class="language- extra-class"><pre class="language-text"><code>module.exports = {
    exec,
    excape: mysql.escape
}

在写sql的地方
username = excape(username)
password = excape(password)

将符号转义  /'
</code></pre></div><h3 id="预防xss"><a href="#预防xss" class="header-anchor">#</a> 预防xss</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i xss

const xss = require('xss')

xss(title)
就完事了
同样是转义解决
</code></pre></div><h3 id="md5加密"><a href="#md5加密" class="header-anchor">#</a> md5加密</h3> <div class="language- extra-class"><pre class="language-text"><code>const crypto = require('crypto')

// 密钥
const SECRET_KEY = 'lz'

// md5加密
function md5(content) {
    let md5 = crypto.createHash('md5')
    return md5.update(content).digest('hex')
}

// 加密函数
function genPassword(password) {
    const str = `password=${password}&amp;key=${SECRET_KEY}`
    return md5(str)
}

module.exports = {
    genPassword
}
</code></pre></div><h3 id="express-2"><a href="#express-2" class="header-anchor">#</a> express</h3> <div class="language- extra-class"><pre class="language-text"><code>npm i express-session
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>npm i redis connect-redis
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>npm i morgan
</code></pre></div><h3 id="koa2"><a href="#koa2" class="header-anchor">#</a> koa2</h3> <p>npm i koa-generator -g</p> <p>koa2 文件名</p> <p>npm i</p> <div class="language- extra-class"><pre class="language-text"><code>npm i koa-generic-session koa-redis redis --registry=https://registry.npm.taobao.org
</code></pre></div><h3 id="pm2"><a href="#pm2" class="header-anchor">#</a> pm2</h3> <p>npm i pm2 -g</p> <p>命令</p> <p>pm2 --version</p> <p>pm2 start 1.js</p> <p>pm2 stop 1.js</p> <p>pm2 list</p> <p>pm2 restart name/id</p> <p>pm2 delete name/id</p> <p>pm2 info name/id</p> <p>pm2 log name/id</p> <p>pm2 monit</p> <h2 id="深入nodejs"><a href="#深入nodejs" class="header-anchor">#</a> 深入nodejs</h2> <h3 id="石头剪刀布"><a href="#石头剪刀布" class="header-anchor">#</a> 石头剪刀布</h3> <div class="language- extra-class"><pre class="language-text"><code>var playAction = process.argv[process.argv.length - 1]
console.log(playAction)

var random = Math.random() * 3

var computerAction = ''
if (random &lt; 1) {
    computerAction = 'rock'
} else if (random &gt; 2) {
    computerAction = 'scissor'
} else {
    computerAction = 'paper'
}

if (computerAction === playAction) {
    console.log('平局')
} else if (
    (computerAction === 'rock' &amp;&amp; playAction === 'paper') ||
    (computerAction === 'scissor' &amp;&amp; playAction === 'rock') ||
    (computerAction === 'paper' &amp;&amp; playAction === 'scissor')
) {
    console.log('你赢了')
} else {
    console.log('你输了')
}
</code></pre></div><h3 id="event"><a href="#event" class="header-anchor">#</a> event</h3> <div class="language- extra-class"><pre class="language-text"><code>const EventEmitter = require('events').EventEmitter

class GeekTime extends EventEmitter {
    constructor () {
        super()
        setInterval(() =&gt; {
            this.emit('newLesson', { price: Math.random() * 100 })
        }, 3000)
    }
}

const geekTime = new GeekTime

geekTime.addListener('newLesson', (e) =&gt; {
    console.log(e)
})
</code></pre></div><h3 id="非阻塞io"><a href="#非阻塞io" class="header-anchor">#</a> 非阻塞io</h3> <div class="language- extra-class"><pre class="language-text"><code>const glob = require('glob')

// 阻塞
var result= null
// console.time('blog')
// result = glob.sync(__dirname + '/**/*')
// console.timeEnd('blog')
// console.log(result)

、、 非阻塞
console.time('blog')
glob(__dirname + '/**/*', (err, res) =&gt; {
    result = res
    // console.log(result)
    console.log('got result')
})
console.timeEnd('blog')
console.log(1 + 1)
</code></pre></div><h3 id="异步编程"><a href="#异步编程" class="header-anchor">#</a> 异步编程</h3> <p>通常回调函数第一个参数为错误信息</p> <h2 id="egg-js"><a href="#egg-js" class="header-anchor">#</a> egg.js</h2> <h3 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h3> <div class="language- extra-class"><pre class="language-text"><code>yarn dev 默认关联config.default.js
yarn start 默认关联config.prod.js

prod默认没有 要自己键
start不用pm2守护 自带进程守护
</code></pre></div><h3 id="配置插件"><a href="#配置插件" class="header-anchor">#</a> 配置插件</h3> <p>在config/plugins.js中配置</p> <div class="language- extra-class"><pre class="language-text"><code>exports.mysql = {
  enable: true,
  package: 'egg-mysql'
}

exports.cors = {
  enable: true,
  package: 'egg-cors'
}

</code></pre></div><p>使用</p> <div class="language- extra-class"><pre class="language-text"><code>  config.mysql = {
    // database configuration
    client: {
      // host
      host: 'localhost',
      // port
      port: '3306',
      // username
      user: 'root',
      // password
      password: 'root',
      // database
      database: 'react_blog',
    },
    // load into app, default is open
    app: true,
    // load into agent, default is close
    agent: false,
  };
  
  
  config.security = {
    csrf: { enable: false },
    domainWhiteList: ['*']
  };
  config.cors = {
    origin: '*', //只允许这个域进行访问接口
    credentials: true,   // 允许cookie跨域
    allowMethods: 'GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS'
  };
</code></pre></div><h2 id="开课吧node"><a href="#开课吧node" class="header-anchor">#</a> 开课吧node</h2> <h3 id="第三方插件"><a href="#第三方插件" class="header-anchor">#</a> 第三方插件</h3> <h4 id="download-git-repo"><a href="#download-git-repo" class="header-anchor">#</a> download-git-repo</h4> <p>下代码插件</p> <div class="language- extra-class"><pre class="language-text"><code>npm i download-git-repo
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>const repo = 'github:su37josephxia/vue-template';
const desc = '../test';
const download = require('download-git-repo')
download(repo,desc,err=&gt; {
  console.log(err ? 'error' : 'ok')
})
</code></pre></div><h4 id="看进度"><a href="#看进度" class="header-anchor">#</a> 看进度</h4> <div class="language- extra-class"><pre class="language-text"><code>npm i ora
const { promisify } = require('util')
util自带，有promise
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>module.exports.clone = async function clone(repo, desc) {
    const { promisify } = require('util')
    const download = promisify(require('download-git-repo'));
    const ora = require('ora');
    const process = ora(`正在下载....${repo}`);
    process.start();
    try {
        await download(repo,desc)
    } catch (error) {
        process.fail()
    }
    process.succeed()

    // download(repo, desc, err =&gt; {
    //     // console.log(err ? 'Error': 'OK')
    //     if (err) {
    //         process.fail();
    //     }
    //     else {
    //         process.succeed();
    //     }
    // });
}

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-blog/assets/js/app.666c71c1.js" defer></script><script src="/vuepress-blog/assets/js/2.b3a7e8a2.js" defer></script><script src="/vuepress-blog/assets/js/1.adc2a77f.js" defer></script><script src="/vuepress-blog/assets/js/124.7708ef5d.js" defer></script>
  </body>
</html>
