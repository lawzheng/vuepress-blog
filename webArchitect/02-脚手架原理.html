<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>站在前端研发的视角，分析开发脚手架的必要性 | Lawz&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/vuepress-blog/logo.jpg">
    <meta name="description" content="罗政的个人博客">
    
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.a53365af.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.fef857e4.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.52cbf88a.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/82.28914eb0.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.45ae65b9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.6c681e4f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.e05150ed.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.86df7c7c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.57923247.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.35e21e35.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.c53bf93c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.5281dcd6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.a460ba23.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.d7995de0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.ca632186.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.86571bbc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.e7dd2c67.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.5fd56a4d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.decc4e21.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.f3bf686a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.35e25ac6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.a2a809b5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.cf26283c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.c0bb7f61.js"><link rel="prefetch" href="/vuepress-blog/assets/js/3.a1060374.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.e9b4bf42.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.6a9fb1ef.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.96fc20cd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.544b532a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.eeae8358.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.eb6f1a52.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.07912d58.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.47575c3f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.480ffe04.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.eb306d98.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.b3237385.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.ce6dcbc4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.89e9a0b6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.2fbf956e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/43.c3b634e5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.1192d919.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.a05fdcd7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.2d8add9d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.929dbff5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.779841a5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/49.9b6b12ce.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.31059d95.js"><link rel="prefetch" href="/vuepress-blog/assets/js/50.468d3901.js"><link rel="prefetch" href="/vuepress-blog/assets/js/51.8168cc01.js"><link rel="prefetch" href="/vuepress-blog/assets/js/52.0cb87ee9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/53.f678c848.js"><link rel="prefetch" href="/vuepress-blog/assets/js/54.64e31343.js"><link rel="prefetch" href="/vuepress-blog/assets/js/55.8a7206f6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/56.318be7d6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/57.27df18d4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/58.6cdb3497.js"><link rel="prefetch" href="/vuepress-blog/assets/js/59.c2b7d937.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.21a47d84.js"><link rel="prefetch" href="/vuepress-blog/assets/js/60.c8e6dab7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/61.d594a948.js"><link rel="prefetch" href="/vuepress-blog/assets/js/62.6467bf5f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/63.7dd59083.js"><link rel="prefetch" href="/vuepress-blog/assets/js/64.07acd178.js"><link rel="prefetch" href="/vuepress-blog/assets/js/65.8d595441.js"><link rel="prefetch" href="/vuepress-blog/assets/js/66.a97af23e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/67.d5fb76f1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/68.921cbfb0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/69.533519de.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.58c9b76c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/70.9b8e44bc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/71.08f8b89f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/72.a5eb5388.js"><link rel="prefetch" href="/vuepress-blog/assets/js/73.20680aff.js"><link rel="prefetch" href="/vuepress-blog/assets/js/74.58dd0d1f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/75.e32e94e1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/76.858c41a3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/77.b4a30b83.js"><link rel="prefetch" href="/vuepress-blog/assets/js/78.8eae35b9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/79.fd864fe6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/8.2c655620.js"><link rel="prefetch" href="/vuepress-blog/assets/js/80.34ef3c72.js"><link rel="prefetch" href="/vuepress-blog/assets/js/81.4792355b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/83.c0745585.js"><link rel="prefetch" href="/vuepress-blog/assets/js/84.0a72c28c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/85.97c4a0f2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/86.fed2b95e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/87.87cfd547.js"><link rel="prefetch" href="/vuepress-blog/assets/js/88.784017d7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/89.1400d960.js"><link rel="prefetch" href="/vuepress-blog/assets/js/9.e41b2676.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.a53365af.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><!----> <span class="site-name">Lawz's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/blog/2022-02-13 vuepress升vitepress.html" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识分类" class="dropdown-title"><span class="title">知识分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="知识分类" class="mobile-dropdown-title"><span class="title">知识分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/01-Html.html" class="nav-link">
  Html
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/02-Css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/03-Js.html" class="nav-link">
  Js
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/04-Browser.html" class="nav-link">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/05-Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/06-React.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/07-Node.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/08-RegEx.html" class="nav-link">
  RegEx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/09-IDE.html" class="nav-link">
  IDE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/10-算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/11-Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/12-Nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/13-Typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/14-webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/15-小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/16-Hybird.html" class="nav-link">
  Hybird
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/17-安全.html" class="nav-link">
  安全
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/18-面试.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/19-网络.html" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/20-知识回顾.html" class="nav-link">
  知识回顾
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/book/2021-03-28 香帅财富报告.html" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="nav-link">
  web架构师
</a></div><div class="nav-item"><a href="https://github.com/lawzheng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/blog/2022-02-13 vuepress升vitepress.html" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识分类" class="dropdown-title"><span class="title">知识分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="知识分类" class="mobile-dropdown-title"><span class="title">知识分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/01-Html.html" class="nav-link">
  Html
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/02-Css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/03-Js.html" class="nav-link">
  Js
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/04-Browser.html" class="nav-link">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/05-Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/06-React.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/07-Node.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/08-RegEx.html" class="nav-link">
  RegEx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/09-IDE.html" class="nav-link">
  IDE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/10-算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/11-Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/12-Nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/13-Typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/14-webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/15-小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/16-Hybird.html" class="nav-link">
  Hybird
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/17-安全.html" class="nav-link">
  安全
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/18-面试.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/19-网络.html" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/20-知识回顾.html" class="nav-link">
  知识回顾
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/book/2021-03-28 香帅财富报告.html" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="nav-link">
  web架构师
</a></div><div class="nav-item"><a href="https://github.com/lawzheng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="sidebar-link">架构师思维</a></li><li><a href="/vuepress-blog/webArchitect/02-脚手架原理.html" class="active sidebar-link">站在前端研发的视角，分析开发脚手架的必要性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#研发效能" class="sidebar-link">研发效能</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架核心价值" class="sidebar-link">脚手架核心价值</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#和自动化构建工具的区别" class="sidebar-link">和自动化构建工具的区别</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#从使用角度理解什么是脚手架" class="sidebar-link">从使用角度理解什么是脚手架</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架简介" class="sidebar-link">脚手架简介</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架执行原理" class="sidebar-link">脚手架执行原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#从应用角度看如何开发一个脚手架" class="sidebar-link">从应用角度看如何开发一个脚手架</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#疑问解答" class="sidebar-link">疑问解答</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架原理进阶" class="sidebar-link">脚手架原理进阶</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架开发流程" class="sidebar-link">脚手架开发流程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#开发流程" class="sidebar-link">开发流程</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#使用流程" class="sidebar-link">使用流程</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架开发难点解析" class="sidebar-link">脚手架开发难点解析</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#脚手架本地link标准流程" class="sidebar-link">脚手架本地link标准流程</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#原生脚手架开发痛点分析" class="sidebar-link">原生脚手架开发痛点分析</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#lerna简介" class="sidebar-link">Lerna简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#优势" class="sidebar-link">优势</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#官网" class="sidebar-link">官网</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#案例" class="sidebar-link">案例</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#lerna开发脚手架流程-重点" class="sidebar-link">lerna开发脚手架流程（重点）</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#lern使用细节-重点" class="sidebar-link">Lern使用细节（重点）</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#yargs使用" class="sidebar-link">yargs使用</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/webArchitect/02-脚手架原理.html#lerna原理-还未深入理解" class="sidebar-link">lerna原理（还未深入理解）</a></li></ul></li><li><a href="/vuepress-blog/webArchitect/03-初始化脚手架.html" class="sidebar-link">初始化脚手架</a></li><li><a href="/vuepress-blog/webArchitect/04-models开发.html" class="sidebar-link">models开发</a></li><li><a href="/vuepress-blog/webArchitect/05-下载项目.html" class="sidebar-link">下载项目</a></li><li><a href="/vuepress-blog/webArchitect/06-安装模板.html" class="sidebar-link">安装模板</a></li><li><a href="/vuepress-blog/webArchitect/07-单元测试.html" class="sidebar-link">单元测试</a></li><li><a href="/vuepress-blog/webArchitect/08-上传.html" class="sidebar-link">上传</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="站在前端研发的视角-分析开发脚手架的必要性"><a href="#站在前端研发的视角-分析开发脚手架的必要性" class="header-anchor">#</a> 站在前端研发的视角，分析开发脚手架的必要性</h1> <h2 id="研发效能"><a href="#研发效能" class="header-anchor">#</a> 研发效能</h2> <p>脚手架的核心目标是：<strong>提升前端研发效能</strong></p> <p>大厂研发架构图：</p> <h2 id="脚手架核心价值"><a href="#脚手架核心价值" class="header-anchor">#</a> 脚手架核心价值</h2> <p>将研发过程：</p> <ul><li>自动化：项目重复代码拷贝/git操作/发布上线操作</li> <li>标准化：项目创建/git flow/发布流程/回滚流程</li> <li>数据化：研发过程系统化、数据化，使得研发过程可量化</li></ul> <h2 id="和自动化构建工具的区别"><a href="#和自动化构建工具的区别" class="header-anchor">#</a> 和自动化构建工具的区别</h2> <p>问题：Jenkins、Travis等自动化构建工具已经比较成熟了，为什么还需要自研脚手架？</p> <ul><li>不满足需求：Jenkins、Travis通常在git hooks中触发，需要在服务端执行（仅仅只能覆盖云构建端的操作），无法覆盖研发人员本地的功能，如：创建项目自动化，本地git操作自动化等</li> <li>定制复杂：Jenkins、Travis定制过程需要开发插件，其过程较为复杂，需要使用java语言，对前端同学不够友好</li></ul> <h2 id="从使用角度理解什么是脚手架"><a href="#从使用角度理解什么是脚手架" class="header-anchor">#</a> 从使用角度理解什么是脚手架</h2> <h3 id="脚手架简介"><a href="#脚手架简介" class="header-anchor">#</a> 脚手架简介</h3> <p>脚手架本质是一个操作系统的客户端，它通过命令执行，比如：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create vue-test-app
</code></pre></div><p>上面命令由3个部分组成：</p> <ul><li>主命令：<code>vue</code></li> <li>command：<code>create</code></li> <li>command的params：<code>vue-test-app</code></li></ul> <p>他表示创建一个vue的项目，项目的名称为<code>vue-test-app</code>，以上是一个较为简单的脚手架命令，但实际场景往往更加复杂，比如：</p> <p>当前目录已经有文件了，我们需要覆盖当前目录下的文件，强制进行安装<code>vue</code>项目，此时我们就可以输入</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create vue-test-app --force
</code></pre></div><p>这里的<code>--force</code>叫做option，用来辅助脚手架确定在特定场景下用户的选择（可以理解为配置）。还有一种场景：</p> <p>通过<code>vue create</code>创建项目时，会自动执行<code>npm install</code>帮用户安装依赖，如果我们希望使用淘宝源来安装，可以使用命令：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create vue-test-app --force -r https://registry.npm.taobao.org
</code></pre></div><p>这里的<code>-r</code>也叫做option，它与<code>--force</code>不同的是它使用<code>-</code>，并且使用了简写，这里的<code>-r</code>也可以替换成<code>--registry</code>，如果不知道<code>vue create</code>支持的所有options，可以使用：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create --help
</code></pre></div><p><code>-r https://registry.npm.taobao.org</code>后面的<code>https://registry.npm.taobao.org</code>成为option的param，其实<code>--force</code>可以理解为：<code>--force true</code>，简写为：<code>--force</code>或<code>-f</code></p> <h3 id="脚手架执行原理"><a href="#脚手架执行原理" class="header-anchor">#</a> 脚手架执行原理</h3> <p>脚手架的执行原理如下：</p> <ul><li>在终端输入<code>vue create vue-test-app</code></li> <li>终端解析出<code>vue</code>命令</li> <li>终端在环境变量中找到<code>vue</code>命令</li> <li>终端根据<code>vue</code>命令链接到实际文件<code>vue.js</code></li> <li>终端利用<code>node</code>执行<code>vue.js</code></li> <li><code>vue.js</code>解析command/options</li> <li><code>vue.js</code>执行command/options</li> <li>执行完毕，退出执行</li></ul> <h2 id="从应用角度看如何开发一个脚手架"><a href="#从应用角度看如何开发一个脚手架" class="header-anchor">#</a> 从应用角度看如何开发一个脚手架</h2> <p>这里以<code>vue-cli</code>为例：</p> <ul><li>开发<code>npm</code>项目，该项目中应包含一个<code>bin/vue.js</code>文件，并将这个项目发布到<code>npm</code></li> <li>将<code>npm</code>项目安装到<code>node</code>的<code>lib/node_modules</code></li> <li>在<code>node</code>的<code>bin</code>目录下配置<code>vue</code>软连接指向<code>lib/node_modules/@vue/cli/bin/vue.js</code></li></ul> <p>这样我们在执行<code>vue</code>命令的时候就可以找到<code>vue.js</code>进行执行</p> <h3 id="疑问解答"><a href="#疑问解答" class="header-anchor">#</a> 疑问解答</h3> <h4 id="为什么全局安装-vue-cli后会添加的命令为vue"><a href="#为什么全局安装-vue-cli后会添加的命令为vue" class="header-anchor">#</a> 为什么全局安装<code>@vue/cli</code>后会添加的命令为<code>vue</code>？</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g @vue/cli
</code></pre></div><p>答：在<code>/usr/local/lib/node_modules/@vue/cli</code>文件夹下的<code>package.json</code>的</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;bin&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token string">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bin/vue.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个软连接的名称就是<code>vue</code>，所以添加后的命令为<code>vue</code></p> <h4 id="全局安装-vue-cli时发生了什么"><a href="#全局安装-vue-cli时发生了什么" class="header-anchor">#</a> 全局安装<code>@vue/cli</code>时发生了什么？</h4> <p>答：先把<code>@vue/cli</code>下载到<code>/usr/local/lib/node_modules</code>中，然后根据<code>@vue/cli</code>下的<code>package.json</code>，根据<code>bin</code>中的定义去<code>/usr/local/bin/</code>下去定义<code>@vue/cli</code>的软连接<code>vue</code></p> <h4 id="执行vue命令时发生了什么-为什么vue指向一个js文件-我们却可以直接通过vue命令去执行它"><a href="#执行vue命令时发生了什么-为什么vue指向一个js文件-我们却可以直接通过vue命令去执行它" class="header-anchor">#</a> 执行<code>vue</code>命令时发生了什么？为什么<code>vue</code>指向一个<code>js</code>文件，我们却可以直接通过<code>vue</code>命令去执行它？</h4> <p>答：1.终端在环境变量中找<code>vue</code>指令（相当于<code>which vue</code>命令），看有没有被注册，未注册则返回<code>command not found</code>,注册了则去找vue指令软连接指向的地址<code>/usr/local/lib/node_modules/@vue/cli/bin/vue.js</code>，去执行<code>vue.js</code>文件中的代码</p> <div class="language- extra-class"><pre><code>	2.因为这个`js`文件的顶部写了`#!/usr/bin/env node`,标识在环境变量中查找`node`，告诉系统使用`node`去执行这个`js`文件
</code></pre></div><h3 id="脚手架原理进阶"><a href="#脚手架原理进阶" class="header-anchor">#</a> 脚手架原理进阶</h3> <h4 id="为什么说脚手架本质是操作系统的客户端-它和我们在pc上安装的应用-软件有什么区别"><a href="#为什么说脚手架本质是操作系统的客户端-它和我们在pc上安装的应用-软件有什么区别" class="header-anchor">#</a> 为什么说脚手架本质是操作系统的客户端？它和我们在PC上安装的应用/软件有什么区别？</h4> <p>1.node在window中是一个node.exe，在Mac中是一个可执行文件（node*）,因为node是操作系统的一个客户端，脚手架的本质是通过node去执行js文件，所以也可以说脚手架的本质是操作系统的客户端。</p> <p>2.本质来说没有区别，PC安装的应用只是提供了一个GUI，脚手架是通过命令的形式</p> <h4 id="如何为node脚手架命令创建别名"><a href="#如何为node脚手架命令创建别名" class="header-anchor">#</a> 如何为node脚手架命令创建别名？</h4> <p>进入<code>/usr/local/bin</code>目录</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ln</span> -s ./imooc-test-cai imooc-test-cai2
</code></pre></div><h4 id="描述脚手架命令执行的全过程。"><a href="#描述脚手架命令执行的全过程。" class="header-anchor">#</a> 描述脚手架命令执行的全过程。</h4> <h2 id="脚手架开发流程"><a href="#脚手架开发流程" class="header-anchor">#</a> 脚手架开发流程</h2> <h3 id="开发流程"><a href="#开发流程" class="header-anchor">#</a> 开发流程</h3> <ul><li><p>创建<code>npm</code>项目</p></li> <li><p>创建脚手架入口文件，最上方添加：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
</code></pre></div></li> <li><p>配置package.json，添加bin属性</p></li> <li><p>编写脚手架代码</p></li> <li><p>将脚手架发布到npm</p></li></ul> <h3 id="使用流程"><a href="#使用流程" class="header-anchor">#</a> 使用流程</h3> <ul><li><p>安装脚手架</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g your-own-cli
</code></pre></div></li> <li><p>使用脚手架</p> <div class="language-bash extra-class"><pre class="language-bash"><code>your-own-cli
</code></pre></div></li></ul> <h3 id="脚手架开发难点解析"><a href="#脚手架开发难点解析" class="header-anchor">#</a> 脚手架开发难点解析</h3> <ul><li><p>分包：将复杂的系统拆分成若干个模块</p></li> <li><p>命令注册：例</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue create
vue <span class="token function">add</span>
vue invoke
</code></pre></div></li> <li><p>参数解析：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>vue <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>params<span class="token operator">&gt;</span>
</code></pre></div><ul><li><p>options全称：<code>--version</code>、<code>--help</code></p></li> <li><p>options简写：<code>-V</code>、<code>-h</code></p></li> <li><p>带params的options：<code>--path /Users/caimengxin/Desktop/vue-test</code></p></li> <li><p>帮助文档：</p> <ul><li>global help
<ul><li>Usage</li> <li>Options</li> <li>Commands</li></ul></li></ul> <p>示例：<code>vue</code>的帮助信息：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Usage: vue <span class="token operator">&lt;</span>command<span class="token operator">&gt;</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

Options:
  -V, --version                              output the version number
  -h, --help                                 output usage information

Commands:
  create <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>app-name<span class="token operator">&gt;</span>                create a new project powered by vue-cli-service
  <span class="token function">add</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>plugin<span class="token operator">&gt;</span> <span class="token punctuation">[</span>pluginOptions<span class="token punctuation">]</span>     <span class="token function">install</span> a plugin and invoke its generator <span class="token keyword">in</span> an already created project
  invoke <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>plugin<span class="token operator">&gt;</span> <span class="token punctuation">[</span>pluginOptions<span class="token punctuation">]</span>  invoke the generator of a plugin <span class="token keyword">in</span> an already created project
  inspect <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>paths<span class="token punctuation">..</span>.<span class="token punctuation">]</span>               inspect the webpack config <span class="token keyword">in</span> a project with vue-cli-service
  serve <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>entry<span class="token punctuation">]</span>                    serve a .js or .vue <span class="token function">file</span> <span class="token keyword">in</span> development mode with zero config
  build <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>entry<span class="token punctuation">]</span>                    build a .js or .vue <span class="token function">file</span> <span class="token keyword">in</span> production mode with zero config
  ui <span class="token punctuation">[</span>options<span class="token punctuation">]</span>                               start and <span class="token function">open</span> the vue-cli ui
  init <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>template<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>app-name<span class="token operator">&gt;</span>       generate a project from a remote template <span class="token punctuation">(</span>legacy API, requires @vue/cli-init<span class="token punctuation">)</span>
  config <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>value<span class="token punctuation">]</span>                   inspect and modify the config
  outdated <span class="token punctuation">[</span>options<span class="token punctuation">]</span>                         <span class="token punctuation">(</span>experimental<span class="token punctuation">)</span> check <span class="token keyword">for</span> outdated vue cli <span class="token function">service</span> / plugins
  upgrade <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>plugin-name<span class="token punctuation">]</span>            <span class="token punctuation">(</span>experimental<span class="token punctuation">)</span> upgrade vue cli <span class="token function">service</span> / plugins
  migrate <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>plugin-name<span class="token punctuation">]</span>            <span class="token punctuation">(</span>experimental<span class="token punctuation">)</span> run migrator <span class="token keyword">for</span> an already-installed cli plugin
  info                                       print debugging information about your environment

  Run vue <span class="token operator">&lt;</span>command<span class="token operator">&gt;</span> --help <span class="token keyword">for</span> detailed usage of given command.

</code></pre></div></li></ul></li></ul> <p>还有很多，比如：</p> <ul><li>命令行交互</li> <li>日志打印</li> <li>命令行文字变色</li> <li>网络通信：HTTP、WebSocket</li> <li>文件处理</li></ul> <p>等等......</p> <h2 id="脚手架本地link标准流程"><a href="#脚手架本地link标准流程" class="header-anchor">#</a> 脚手架本地link标准流程</h2> <p>链接本地脚手架：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> your-cli-dir
<span class="token function">npm</span> <span class="token function">link</span>
</code></pre></div><p>链接本地库文件：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> your-lib-dir
<span class="token function">npm</span> <span class="token function">link</span>
<span class="token builtin class-name">cd</span> your-cli-dir
<span class="token function">npm</span> <span class="token function">link</span> your-lib
</code></pre></div><p>取消链接本地库文件：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> your-lib-dir
<span class="token function">npm</span> unlink
<span class="token builtin class-name">cd</span> your-cli-dir
<span class="token comment"># link存在</span>
<span class="token function">npm</span> unlink your-lib
<span class="token comment"># link不存在</span>
<span class="token function">rm</span> -rf node_modules
<span class="token function">npm</span> <span class="token function">install</span> -S your-lib
</code></pre></div><p>理解<code>npm unlink</code>：</p> <ul><li><code>npm link your-lib</code>：将当前项目中的<code>node_modules</code>下指定的库文件链接到<code>node</code>全局<code>node_modules</code>下的库文件</li> <li><code>npm link</code>：将当前项目链接到<code>node</code>全局<code>node_modules</code>中作为一个库文件，并解析<code>bin</code>配置创建可执行文件</li></ul> <p>理解<code>npm unlink</code>：</p> <ul><li><code>npm unlink</code>：将当前项目从<code>node</code>全局<code>node_modules</code>中移除</li> <li><code>npm unlink your-lib</code>：将当前项目中的库文件依赖移除</li></ul> <h2 id="原生脚手架开发痛点分析"><a href="#原生脚手架开发痛点分析" class="header-anchor">#</a> 原生脚手架开发痛点分析</h2> <ul><li>痛点一：重复操作
<ul><li>多Package本地link</li> <li>多Package依赖安装</li> <li>多Package单元测试</li> <li>多Package代码提交</li> <li>多Package代码发布</li></ul></li> <li>痛点二：版本一致性
<ul><li>发布时版本一致性</li> <li>发布后相互依赖版本升级</li></ul></li></ul> <p><strong>package越多，管理复杂度越高</strong></p> <h2 id="lerna简介"><a href="#lerna简介" class="header-anchor">#</a> Lerna简介</h2> <blockquote><p>Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.</p></blockquote> <p>Lerna是一个优化基于git+npm的多package项目的管理工具</p> <h3 id="优势"><a href="#优势" class="header-anchor">#</a> 优势</h3> <ul><li>大幅减少重复操作</li> <li>提升操作的标准化</li></ul> <blockquote><p>Lerna是架构优化的产物，它揭示了一个架构真理：项目复杂度提升后，就需要对项目进行架构优化。架构优化的主要目标往往都是以效能为核心。</p></blockquote> <h3 id="官网"><a href="#官网" class="header-anchor">#</a> 官网</h3> <p>官网：https://lerna.js.org/</p> <h3 id="案例"><a href="#案例" class="header-anchor">#</a> 案例</h3> <p>使用Lerna管理的大型项目：</p> <ul><li>babel：https://github.com/babel/babel</li> <li>vue-cli：https://github.com/vuejs/vue-cli</li> <li>create-react-app：https://github.com/facebook/create-react-app</li></ul> <h3 id="lerna开发脚手架流程-重点"><a href="#lerna开发脚手架流程-重点" class="header-anchor">#</a> lerna开发脚手架流程（重点）</h3> <h3 id="lern使用细节-重点"><a href="#lern使用细节-重点" class="header-anchor">#</a> Lern使用细节（重点）</h3> <ul><li><p><code>lerna init</code>:</p> <p>会自动完成<code>git</code>初始化，但不会创建<code>.gitignore</code>文件，这个必须要手动添加，否则会将<code>node_modules</code>目录都上传到<code>git</code>，如果<code>node_modules</code>已经加入到<code>git stage</code>，可使用：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> reset HEAD <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>
</code></pre></div><p>执行<code>unstage</code>操作，如果文件已经被<code>git</code>监听到变更，可使用：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> checkout -- <span class="token operator">&lt;</span>filename<span class="token operator">&gt;</span>
</code></pre></div><p>将变更作废，记得在执行操作之前将文件加入：<code>.gitignore</code></p></li> <li><p><code>lerna add</code>：</p> <ul><li>第一个参数：添加npm包名</li> <li>第二个参数：本地package的路径</li> <li>选项：
<ul><li><code>--dev</code>：将依赖安装到<code>devDependencies</code>，不加时安装到<code>dependencies</code></li></ul></li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>lerna <span class="token function">add</span> <span class="token operator">&lt;</span>package<span class="token operator">&gt;</span> <span class="token punctuation">[</span>loc<span class="token punctuation">]</span> --dev
</code></pre></div></li> <li><p><code>lerna link</code>：</p> <p>如果未发布上线，需要手动将依赖添加到<code>package.json</code>，再执行<code>npm link</code></p></li> <li><p><code>lerna clean</code>：</p> <p>只会删除<code>node_modules</code>，不会删除<code>package.json</code>中的依赖</p></li> <li><p><code>lerna exec</code>和<code>lerna run</code>：</p> <p><code>--scope</code>属性后添加的是包名，而不是<code>package</code>的路径，这点和<code>lerna add</code>用法不同</p></li> <li><p><code>lerna publish</code></p> <ul><li>发布时会自动执行：<code>git add package-lock.json</code>，所以package-lock.json不要加入<code>.gitignore</code>文件</li> <li>先创建远程仓库，并且同步一次master分支</li> <li>执行<code>lerna publish</code>前先完成<code>npm login</code></li> <li>如果发布的npm包名为：<code>@xxx/yyy</code>的格式，需要先在npm注册名为：xxx的organization，否则可能会提交不成功</li> <li>发布到<code>npm group</code>时默认为private，所以我们需要手动在<code>package.json</code>中添加如下设置</li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">&quot;publishConfig&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token string">&quot;access&quot;</span><span class="token operator">:</span><span class="token string">&quot;public&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="yargs使用"><a href="#yargs使用" class="header-anchor">#</a> yargs使用</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code>#<span class="token operator">!</span> <span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node

<span class="token keyword">const</span> yargs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yargs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> dedent <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dedent'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../package.json'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> cli <span class="token operator">=</span> <span class="token function">yargs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> argv <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token punctuation">{</span>
  imoocVersion<span class="token operator">:</span> pkg<span class="token punctuation">.</span>version
<span class="token punctuation">}</span>
cli
	<span class="token comment">// 配置 第一行的使用提示</span>
  <span class="token punctuation">.</span><span class="token function">usage</span><span class="token punctuation">(</span><span class="token string">'Usage: imooc-cli-cai [command] &lt;options&gt;'</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 提示用户脚手架最少要接收一个命令</span>
  <span class="token punctuation">.</span><span class="token function">demandCommand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'A command is required. Pass --help to see all available commands and options.'</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 命令输入错误或者没有此命令的时候可以根据输入推荐合适的命令</span>
  <span class="token punctuation">.</span><span class="token function">recommendCommands</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 命令错误时执行的方法</span>
  <span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>msg</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
	 <span class="token comment">// 配置 help和version的别名</span>
  <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'version'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token string">'h'</span><span class="token punctuation">,</span><span class="token string">'help'</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 终端宽度</span>
  <span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span>cli<span class="token punctuation">.</span><span class="token function">terminalWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 尾部的提示文字</span>
  <span class="token punctuation">.</span><span class="token function">epilogue</span><span class="token punctuation">(</span>dedent<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
      when a command fails,all logs are written to lerna-debug.log in the current working directory.

      For more information,find our manual at https://github.com/lerna/lerna
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 debug命令</span>
    <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      debug<span class="token operator">:</span><span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">&quot;boolean&quot;</span><span class="token punctuation">,</span>
        describe<span class="token operator">:</span> <span class="token string">&quot;Bootstrap debug mode&quot;</span><span class="token punctuation">,</span>
        alias<span class="token operator">:</span> <span class="token string">&quot;d&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 registry命令</span>
    <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'registry'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span>
      describe<span class="token operator">:</span> <span class="token string">&quot;Define global registry&quot;</span><span class="token punctuation">,</span>
      alias<span class="token operator">:</span> <span class="token string">'r'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 分组</span>
    <span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'debug'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Dev Options'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'registry'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'Extra Options'</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 命令，当执行 init [name] 命令的时候一系列的行为</span>
    <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'init [name]'</span><span class="token punctuation">,</span> <span class="token string">'Do init a project'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">yargs</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      yargs
        <span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
          type<span class="token operator">:</span> <span class="token string">'string'</span><span class="token punctuation">,</span>
          describe<span class="token operator">:</span> <span class="token string">'Name of a project'</span><span class="token punctuation">,</span>
          alias<span class="token operator">:</span> <span class="token string">'n'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">argv</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>argv<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 命令的第二种方法</span>
    <span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      command<span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
      aliases<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ls'</span><span class="token punctuation">,</span><span class="token string">'ll'</span><span class="token punctuation">,</span><span class="token string">'la'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      describe<span class="token operator">:</span> <span class="token string">'List local packages'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">builder</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">yargs</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">argv</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>argv<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// 配置 严格模式，最后一行提示命令错误，如：无法识别的选项：lis</span>
  <span class="token punctuation">.</span><span class="token function">strict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 	<span class="token comment">// 解析参数</span>
  <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>argv<span class="token punctuation">,</span>context<span class="token punctuation">)</span>

</code></pre></div><h2 id="lerna原理-还未深入理解"><a href="#lerna原理-还未深入理解" class="header-anchor">#</a> lerna原理（还未深入理解）</h2> <ul><li>通过import-local来优先调用本地lerna命令</li> <li>通过Yargs初始化脚手架，然后注册全局属性，再注册命令，最后通过parse方法解析参数</li> <li>lerna命令注册时需要传入build和handler两个函数，build用来注册命令专属的options，handler用来处理命令的业务逻辑</li> <li>lerna通过配置npm本地依赖的方式进行本地开发，具体写法是在package.json中写入：file:your-locale-module-path,在lerna publish的时候会自动替换路径</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="prev">
        架构师思维
      </a></span> <span class="next"><a href="/vuepress-blog/webArchitect/03-初始化脚手架.html">
        初始化脚手架
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-blog/assets/js/app.fef857e4.js" defer></script><script src="/vuepress-blog/assets/js/2.52cbf88a.js" defer></script><script src="/vuepress-blog/assets/js/82.28914eb0.js" defer></script>
  </body>
</html>
