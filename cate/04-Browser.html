<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>浏览器 | Lawz&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/vuepress-blog/logo.jpg">
    <meta name="description" content="罗政的个人博客">
    
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.a53365af.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.e25d0ce9.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.52cbf88a.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/70.06bc8257.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.45ae65b9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.6c681e4f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.e05150ed.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.86df7c7c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.57923247.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.35e21e35.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.c53bf93c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.5281dcd6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.a460ba23.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.d7995de0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.ca632186.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.86571bbc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.e7dd2c67.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.5fd56a4d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.decc4e21.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.f3bf686a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.35e25ac6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.a2a809b5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.cf26283c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.c0bb7f61.js"><link rel="prefetch" href="/vuepress-blog/assets/js/3.a1060374.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.e9b4bf42.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.6a9fb1ef.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.96fc20cd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.544b532a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.1cd4a522.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.f055210f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.07912d58.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.47575c3f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.480ffe04.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.eb306d98.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.fb833111.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.ce6dcbc4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.89e9a0b6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.2fbf956e.js"><link rel="prefetch" href="/vuepress-blog/assets/js/43.c3b634e5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.1192d919.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.a05fdcd7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.2d8add9d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.929dbff5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.779841a5.js"><link rel="prefetch" href="/vuepress-blog/assets/js/49.9b6b12ce.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.31059d95.js"><link rel="prefetch" href="/vuepress-blog/assets/js/50.468d3901.js"><link rel="prefetch" href="/vuepress-blog/assets/js/51.8168cc01.js"><link rel="prefetch" href="/vuepress-blog/assets/js/52.89e24654.js"><link rel="prefetch" href="/vuepress-blog/assets/js/53.f678c848.js"><link rel="prefetch" href="/vuepress-blog/assets/js/54.64e31343.js"><link rel="prefetch" href="/vuepress-blog/assets/js/55.eb36f4b3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/56.d5c1a090.js"><link rel="prefetch" href="/vuepress-blog/assets/js/57.3e024332.js"><link rel="prefetch" href="/vuepress-blog/assets/js/58.c3c0cd21.js"><link rel="prefetch" href="/vuepress-blog/assets/js/59.27c67c12.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.21a47d84.js"><link rel="prefetch" href="/vuepress-blog/assets/js/60.7cb3d7b6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/61.e20bcaae.js"><link rel="prefetch" href="/vuepress-blog/assets/js/62.ffafabc4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/63.0eecb439.js"><link rel="prefetch" href="/vuepress-blog/assets/js/64.12d8d60f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/65.4dcd04d3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/66.31c72897.js"><link rel="prefetch" href="/vuepress-blog/assets/js/67.53c88408.js"><link rel="prefetch" href="/vuepress-blog/assets/js/68.3df28487.js"><link rel="prefetch" href="/vuepress-blog/assets/js/69.3c206480.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.58c9b76c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/71.47ac1db1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/72.71c1bd78.js"><link rel="prefetch" href="/vuepress-blog/assets/js/73.bc218a03.js"><link rel="prefetch" href="/vuepress-blog/assets/js/74.069ec6c1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/75.0b3948c4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/76.88c60db0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/77.a9e84280.js"><link rel="prefetch" href="/vuepress-blog/assets/js/78.42a424db.js"><link rel="prefetch" href="/vuepress-blog/assets/js/79.ff69c0fa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/8.2c655620.js"><link rel="prefetch" href="/vuepress-blog/assets/js/80.cd9a13b7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/81.bfb9f69f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/82.50420910.js"><link rel="prefetch" href="/vuepress-blog/assets/js/83.d912d6bb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/84.2abf1079.js"><link rel="prefetch" href="/vuepress-blog/assets/js/85.e7fbf5cb.js"><link rel="prefetch" href="/vuepress-blog/assets/js/86.4dc53c3d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/87.1b16adc6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/88.da2400b3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/89.8dfa2393.js"><link rel="prefetch" href="/vuepress-blog/assets/js/9.e41b2676.js"><link rel="prefetch" href="/vuepress-blog/assets/js/90.a41c1f42.js"><link rel="prefetch" href="/vuepress-blog/assets/js/91.44a6e34b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/92.0ce1dfb7.js"><link rel="prefetch" href="/vuepress-blog/assets/js/93.fd7b1a0f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/94.97ed5642.js"><link rel="prefetch" href="/vuepress-blog/assets/js/95.a55ab8de.js"><link rel="prefetch" href="/vuepress-blog/assets/js/96.5e96c4e4.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.a53365af.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><!----> <span class="site-name">Lawz's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/blog/2022-06-25 项目添加husky.html" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识分类" class="dropdown-title"><span class="title">知识分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="知识分类" class="mobile-dropdown-title"><span class="title">知识分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/01-Html.html" class="nav-link">
  Html
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/02-Css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/03-Js.html" class="nav-link">
  Js
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/04-Browser.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/05-Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/06-React.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/07-Node.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/08-RegEx.html" class="nav-link">
  RegEx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/09-IDE.html" class="nav-link">
  IDE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/10-算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/11-Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/12-Nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/13-Typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/14-webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/15-小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/16-Hybird.html" class="nav-link">
  Hybird
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/17-安全.html" class="nav-link">
  安全
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/18-面试.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/19-网络.html" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/20-知识回顾.html" class="nav-link">
  知识回顾
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/book/2021-03-28 香帅财富报告.html" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="nav-link">
  web架构师
</a></div><div class="nav-item"><a href="https://github.com/lawzheng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/blog/2022-06-25 项目添加husky.html" class="nav-link">
  博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识分类" class="dropdown-title"><span class="title">知识分类</span> <span class="arrow down"></span></button> <button type="button" aria-label="知识分类" class="mobile-dropdown-title"><span class="title">知识分类</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/01-Html.html" class="nav-link">
  Html
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/02-Css.html" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/03-Js.html" class="nav-link">
  Js
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/04-Browser.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Browser
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/05-Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/06-React.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/07-Node.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/08-RegEx.html" class="nav-link">
  RegEx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/09-IDE.html" class="nav-link">
  IDE
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/10-算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/11-Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/12-Nginx.html" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/13-Typescript.html" class="nav-link">
  Typescript
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/14-webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/15-小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/16-Hybird.html" class="nav-link">
  Hybird
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/17-安全.html" class="nav-link">
  安全
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/18-面试.html" class="nav-link">
  面试
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/19-网络.html" class="nav-link">
  网络
</a></li><li class="dropdown-item"><!----> <a href="/vuepress-blog/cate/20-知识回顾.html" class="nav-link">
  知识回顾
</a></li></ul></div></div><div class="nav-item"><a href="/vuepress-blog/book/2021-03-28 香帅财富报告.html" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="/vuepress-blog/webArchitect/01-架构师思维.html" class="nav-link">
  web架构师
</a></div><div class="nav-item"><a href="https://github.com/lawzheng" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>浏览器</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/cate/04-Browser.html#浏览器" class="sidebar-link">浏览器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#跨标签页通讯" class="sidebar-link">跨标签页通讯</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#浏览器架构" class="sidebar-link">浏览器架构</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#浏览器下事件循环-event-loop" class="sidebar-link">浏览器下事件循环(Event Loop)</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#从输入-url-到展示的过程" class="sidebar-link">从输入 url 到展示的过程</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#重绘与回流" class="sidebar-link">重绘与回流</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#存储" class="sidebar-link">存储</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#web-worker" class="sidebar-link">Web Worker</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#v8垃圾回收机制" class="sidebar-link">V8垃圾回收机制</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/cate/04-Browser.html#内存泄露" class="sidebar-link">内存泄露</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="浏览器"><a href="#浏览器" class="header-anchor">#</a> 浏览器</h2> <h3 id="跨标签页通讯"><a href="#跨标签页通讯" class="header-anchor">#</a> 跨标签页通讯</h3> <p>不同标签页间的通讯，本质原理就是去运用一些可以 <strong>共享的中间介质</strong>，因此比较常用的有以下方法:</p> <ul><li>通过父页面<code>window.open()</code>和子页面<code>postMessage</code> <ul><li>异步下，通过 <code>window.open('about: blank')</code> 和 <code>tab.location.href = '*'</code></li></ul></li> <li>设置同域下共享的<code>localStorage</code>与监听<code>window.onstorage</code> <ul><li>重复写入相同的值无法触发</li> <li>会受到浏览器隐身模式等的限制</li></ul></li> <li>设置共享<code>cookie</code>与不断轮询脏检查(<code>setInterval</code>)</li> <li>借助服务端或者中间层实现</li></ul> <h3 id="浏览器架构"><a href="#浏览器架构" class="header-anchor">#</a> 浏览器架构</h3> <ul><li>用户界面</li> <li>主进程</li> <li>内核
<ul><li>渲染引擎</li> <li>JS 引擎
<ul><li>执行栈</li></ul></li> <li>事件触发线程
<ul><li>消息队列
<ul><li>微任务</li> <li>宏任务</li></ul></li></ul></li> <li>网络异步线程</li> <li>定时器线程</li></ul></li></ul> <h3 id="浏览器下事件循环-event-loop"><a href="#浏览器下事件循环-event-loop" class="header-anchor">#</a> 浏览器下事件循环(Event Loop)</h3> <p>事件循环是指: 执行一个宏任务，然后执行清空微任务列表，循环再执行宏任务，再清微任务列表</p> <ul><li>微任务 <code>microtask(jobs)</code>: <code>promise / ajax / Object.observe(该方法已废弃)</code></li> <li>宏任务 <code>macrotask(task)</code>: <code>setTimout / script / IO / UI Rendering</code></li></ul> <h3 id="从输入-url-到展示的过程"><a href="#从输入-url-到展示的过程" class="header-anchor">#</a> 从输入 url 到展示的过程</h3> <ul><li>DNS 解析</li> <li>TCP 三次握手</li> <li>发送请求，分析 url，设置请求报文(头，主体)</li> <li>服务器返回请求的文件 (html)</li> <li>浏览器渲染
<ul><li>HTML parser --&gt; DOM Tree
<ul><li>标记化算法，进行元素状态的标记</li> <li>dom 树构建</li></ul></li> <li>CSS parser --&gt; Style Tree
<ul><li>解析 css 代码，生成样式树</li></ul></li> <li>attachment --&gt; Render Tree
<ul><li>结合 dom树 与 style树，生成渲染树</li></ul></li> <li>layout: 布局</li> <li>GPU painting: 像素绘制页面</li></ul></li></ul> <h3 id="重绘与回流"><a href="#重绘与回流" class="header-anchor">#</a> 重绘与回流</h3> <p>当元素的样式发生变化时，浏览器需要触发更新，重新绘制元素。这个过程中，有两种类型的操作，即重绘与回流。</p> <ul><li><strong>重绘(repaint)</strong>: 当元素样式的改变不影响布局时，浏览器将使用重绘对元素进行更新，此时由于只需要UI层面的重新像素绘制，因此 <strong>损耗较少</strong></li> <li><strong>回流(reflow)</strong>: 当元素的尺寸、结构或触发某些属性时，浏览器会重新渲染页面，称为回流。此时，浏览器需要重新经过计算，计算后还需要重新页面布局，因此是较重的操作。会触发回流的操作:
<ul><li>页面初次渲染</li> <li>浏览器窗口大小改变</li> <li>元素尺寸、位置、内容发生改变</li> <li>元素字体大小变化</li> <li>添加或者删除可见的 dom 元素</li> <li>激活 CSS 伪类（例如：:hover）</li> <li>查询某些属性或调用某些方法
<ul><li>clientWidth、clientHeight、clientTop、clientLeft</li> <li>offsetWidth、offsetHeight、offsetTop、offsetLeft</li> <li>scrollWidth、scrollHeight、scrollTop、scrollLeft</li> <li>getComputedStyle()</li> <li>getBoundingClientRect()</li> <li>scrollTo()</li></ul></li></ul></li></ul> <p><strong>回流必定触发重绘，重绘不一定触发回流。重绘的开销较小，回流的代价较高。</strong></p> <h4 id="最佳实践"><a href="#最佳实践" class="header-anchor">#</a> 最佳实践:</h4> <ul><li>css
<ul><li>避免使用<code>table</code>布局</li> <li>将动画效果应用到<code>position</code>属性为<code>absolute</code>或<code>fixed</code>的元素上</li></ul></li> <li>javascript
<ul><li>避免频繁操作样式，可汇总后统一 <strong>一次修改</strong></li> <li>尽量使用<code>class</code>进行样式修改</li> <li>减少<code>dom</code>的增删次数，可使用 <strong>字符串</strong> 或者 <code>documentFragment</code> 一次性插入</li> <li>极限优化时，修改样式可将其<code>display: none</code>后修改</li> <li>避免多次触发上面提到的那些会触发回流的方法，可以的话尽量用 <strong>变量存住</strong></li></ul></li></ul> <h3 id="存储"><a href="#存储" class="header-anchor">#</a> 存储</h3> <p>我们经常需要对业务中的一些数据进行存储，通常可以分为 短暂性存储 和 持久性储存。</p> <ul><li><p>短暂性的时候，我们只需要将数据存在内存中，只在运行时可用</p></li> <li><p>持久性存储，可以分为 浏览器端 与 服务器端</p> <ul><li><p>浏览器:</p> <ul><li><div class="language- extra-class"><pre class="language-text"><code>cookie
</code></pre></div><p>: 通常用于存储用户身份，登录状态等</p> <ul><li>http 中自动携带， 体积上限为 4K， 可自行设置过期时间</li></ul></li> <li><p><code>localStorage / sessionStorage</code>: 长久储存/窗口关闭删除， 体积限制为 4~5M</p></li> <li><p><code>indexDB</code></p></li></ul></li> <li><p>服务器:</p> <ul><li>分布式缓存 redis</li> <li>数据库</li></ul></li></ul></li></ul> <h3 id="web-worker"><a href="#web-worker" class="header-anchor">#</a> Web Worker</h3> <p>一般有耗时任务才使用</p> <p>现代浏览器为<code>JavaScript</code>创造的 <strong>多线程环境</strong>。可以新建并将部分任务分配到<code>worker</code>线程并行运行，两个线程可 <strong>独立运行，互不干扰</strong>，可通过自带的 <strong>消息机制</strong> 相互通信。</p> <p><strong>基本用法:</strong></p> <div class="language- extra-class"><pre class="language-text"><code>// 创建 worker
const worker = new Worker('work.js');

// 向主进程推送消息
worker.postMessage('Hello World');

// 监听主进程来的消息
worker.onmessage = function (event) {
  console.log('Received message ' + event.data);
}
复制代码
</code></pre></div><p><strong>限制:</strong></p> <ul><li>同源限制</li> <li>无法使用 <code>document</code> / <code>window</code> / <code>alert</code> / <code>confirm</code></li> <li>无法加载本地资源</li></ul> <h3 id="v8垃圾回收机制"><a href="#v8垃圾回收机制" class="header-anchor">#</a> V8垃圾回收机制</h3> <p>垃圾回收: 将内存中不再使用的数据进行清理，释放出内存空间。V8 将内存分成 <strong>新生代空间</strong> 和 <strong>老生代空间</strong>。</p> <ul><li><p>新生代空间</p> <p>: 用于存活较短的对象</p> <ul><li>又分成两个空间: from 空间 与 to 空间</li> <li>Scavenge GC算法: 当 from 空间被占满时，启动 GC 算法
<ul><li>存活的对象从 from space 转移到 to space</li> <li>清空 from space</li> <li>from space 与 to space 互换</li> <li>完成一次新生代GC</li></ul></li></ul></li> <li><p>老生代空间</p> <p>: 用于存活时间较长的对象</p> <ul><li><p>从 新生代空间 转移到 老生代空间 的条件</p> <ul><li>经历过一次以上 Scavenge GC 的对象</li> <li>当 to space 体积超过25%</li></ul></li> <li><p>标记清除算法</p> <p>: 标记存活的对象，未被标记的则被释放</p> <ul><li>增量标记: 小模块标记，在代码执行间隙执，GC 会影响性能</li> <li>并发标记(最新技术): 不阻塞 js 执行</li></ul></li> <li><p><strong>压缩算法</strong>: 将内存中清除后导致的碎片化对象往内存堆的一端移动，解决 <strong>内存的碎片化</strong></p></li></ul></li></ul> <h3 id="内存泄露"><a href="#内存泄露" class="header-anchor">#</a> 内存泄露</h3> <ul><li>意外的<strong>全局变量</strong>: 无法被回收</li> <li><strong>定时器</strong>: 未被正确关闭，导致所引用的外部变量无法被释放</li> <li><strong>事件监听</strong>: 没有正确销毁 (低版本浏览器可能出现)</li> <li><strong>闭包</strong>: 会导致父级中的变量无法被释放</li> <li><strong>dom 引用</strong>: dom 元素被删除时，内存中的引用未被正确清空</li></ul> <p>可用 chrome 中的 timeline 进行内存标记，可视化查看内存的变化情况，找出异常点。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-blog/assets/js/app.e25d0ce9.js" defer></script><script src="/vuepress-blog/assets/js/2.52cbf88a.js" defer></script><script src="/vuepress-blog/assets/js/70.06bc8257.js" defer></script>
  </body>
</html>
